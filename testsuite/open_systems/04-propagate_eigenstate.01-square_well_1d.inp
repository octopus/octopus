# -*- coding: utf-8 -*-
#
# $Id$
#
# Calculate extended eigenstate of an attractive square
# potential barrier in 1D and propagate it.

ParallelizationStrategy = par_kpoints
MeshBlockSizeXY = 1
MeshBlockSizeZ = 1
DevelVersion = yes

%CalculationMode
 gs      | gs      | td
 "lead_" | "well_" | "well_"
 1       | 2       | 3
%

FromScratch = yes
TheoryLevel = independent_particles
DerivativesOrder = 4
Eigensolver = lobpcg
BoxShape = parallelepiped
Dimensions = 1
Spacing = 0.1
Lx = 20

TDMaximumIter = 300
TDTimeStep = 0.5

V = 0.5
W = 10
%Species
 "flat" | 0 | user_defined | 2.0 | "0"
# "well" | 0 | user_defined | 2.0 | "V*(-step(x+W/2)+step(x-W/2))" # do NOT use in this form: bug in the parser on ppc
 "well" | 0 | user_defined | 2.0 | "-V*step(x+W/2)*step(W/2-x)"
%


# The lead.
lead_PeriodicDimensions = 1
%lead_Coordinates
 "flat" | 0 | 0 | 0
%

%lead_Lsize
 50*DerivativesOrder*Spacing/2 | 0 | 0
%

%KPointsGrid 
  4 | 1 | 1
1/2 | 1/2 | 1/2
%
KPointsUseSymmetries = false

lead_Output = potential
lead_OutputHow = binary


# The extended system with scattering center.
add_ucells = 2 
%well_OpenBoundaries
 lead_dataset     | "lead_"
 lead_restart_dir | "lead_restart"
 lead_static_dir  | "lead_static"
 add_unit_cells   | add_ucells
 td_pot_formula   | "0.0"   | "0.0"
%
well_OpenBoundariesQMRMaxIter = 1000

%well_Coordinates
 "well" | 0 | 0 | 0
%

%well_Lsize
 20 | 0 | 0
%

well_EigenSolverMaxiter = 5000
EigensolverFinalTolerance = 1e-9

