# -*- coding: utf-8 mode: shell-script -*-
# $Id: 03-asym_doublewell.test 3193 2007-09-09 23:14:17Z acastro $

Test       : OCT with local target
Author     : Alberto
Date       : 07.09.07
Arch       : Linux 
Release    : 2.6.21
Programs   : octopus
TestGroups : long-run, oct
Enabled    : Yes

# The test ensures that the OCT with local target works.
# 
# We do the following intermediate steps:
# First, the two lowest eigenstates of the asymmetric double well,
# V(x) = 1/64*(x)^4-1/4*(x)^2+1/256*(x)^3,
# are calculated. 
# A similar potential is used in Rev Mod (Haenggi, Griffoni)

Input: 03-localtarget.01-gs.inp
Match ; TotalEnergy ; sed -n '/^Energy/{n\;p\;}' static/info ; \s*Total\s*=\s*-0.6206

# Then, run the optimization for two iterations and check the convergence.
# Note that this run only converges to an almost perfect overlap with
# the target density after a lot of iterations (e.g., if we run over
# 100 iterations we reach J1 = -0.01156, with J1=0 implying perfect
# overlap and J1 = -2 to overlap at all.
Input: 03-localtarget.02-oct.inp
Match ; J1 2nd iteration  ; grep ' 2  ' opt-control/convergence ; \s*-0.398\d*

# Now we check that the many-particle version of the QOCT optimization of
# local targets also works.

Input: 03-localtarget.03-gs-mp.inp
Match ; TotalEnergy ; sed -n '/^Energy/{n\;p\;}' static/info ; \s*Total\s*=\s*-2.1689

# Now once again we run for a couple of iterations and check the convergence.
# In this case, after 25 iterations we reach J1 approx -1.81
Input: 03-localtarget.04-oct-mp.inp
Match ; J1 2nd iteration  ; grep ' 2  ' opt-control/convergence ; \s*-4.098\d*
