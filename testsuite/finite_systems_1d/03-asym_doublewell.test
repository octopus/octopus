# $Id: 03-asym_doublewell.test 2072 2006-05-14 10:45:38Z athimm $

Test     : Asymmetric Double Well
Author   : Jan
Date     : 19.05.06
Arch     : Linux 
Release  :
Programs : octopus
Runtime  : short-run
Enabled  : Yes

# The test ensures the optimal control algorithm ZBR98. It calculates the optimal laser field that transfers the ground-state to the first excited state. 
# 
# We do the following intermediate steps:
# First, the two lowest eigenstates of the asymmetric double well,
# V(x) = 1/64*(x)^4-1/4*(x)^2+1/256*(x)^3,
# are calculated. 
# A similar potential is used in Rev Mod (Haenggi, Griffoni)

Input: 03-asym_doublewell.01-ground_state.inp

Match ; TotalEnergy ; grep -A 7 '^Energy:' ground_state_static/info ; \s*Total\s*=\s*-0.6206
Match ; 2th state  ; grep '2   --' excited_states_static/eigenvalues ; \s*-0.4638 

# Then, run the optimization for 5 iterations and compare the convergence.

Input: 03-asym_doublewell.02-oct_run.inp

# No match yet
Match ; J1 1st iteration  ; grep ' 1  ' opt-control/convergence ; \s*0.4410\d*
Match ; J1 2nd iteration  ; grep ' 2  ' opt-control/convergence ; \s*0.5872\d*
Match ; J1 3rd iteration  ; grep ' 3  ' opt-control/convergence ; \s*0.6079\d*
