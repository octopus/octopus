# -*- coding: utf-8 mode: shell-script -*-

Test       : Free Maxwell propagation through a linear medium (defined in a file)
Program    : octopus
TestGroups : long-run, maxwell
Enabled    : Yes


# Cosinoidal pulse polarized in z-direction passing through medium box read from file
Processors : 2
ExtraFile  : 04-linear-medium-from-file.01-cube.off
Input      : 04-linear-medium-from-file.01-cube_medium_from_file.inp

if(available cgal); then
Precision: 1.0e-13
match ;   Tot. Maxwell energy [step 10]   ; LINEFIELD(Maxwell/td.general/maxwell_energy, 16, 3) ; 26.44226450938
Precision: 1.0e-12
match ;   Tot. Maxwell energy [step 30]   ; LINEFIELD(Maxwell/td.general/maxwell_energy, 36, 3) ; 156.1944406603

Precision: 1.0e-23
match ;   Ez  (x=  0,y=  0,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.y=0\,z=0, 30, 2) ; 1.74289676059645e-13
match ;   Ez  (x=  0,y= 10,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.x=0\,z=0, 40, 2) ; -3.76210729612677e-10

match ;   Ez  (x=  0,y=  0,z=-10) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.x=0\,y=0, 20, 2) ; 1.47579670764209e-10
match ;   Ez  (x=  0,y=  0,z= 10) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.x=0\,y=0, 40, 2) ; 1.47579674620775e-10
match ;   Ez  (x=  0,y=-10,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.x=0\,z=0, 20, 2) ; -3.76211687575571e-10

match ;   By  (x=  0,y=-10,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.x=0\,z=0, 20, 2) ; -2.1538632456078e-12
match ;   By  (x=  0,y= 10,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.x=0\,z=0, 40, 2) ; -2.15386301423294e-12

match ;   By  (x=  0,y=  0,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.x=0\,z=0, 30, 2) ; -2.5387609319342e-15
match ;   By  (x=  0,y=  0,z=-10) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.x=0\,y=0, 20, 2) ; 5.4907353733873e-12
match ;   By  (x=  0,y=  0,z= 10) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.x=0\,y=0, 40, 2) ; 5.49073479222524e-12


Precision: 1.0e-17
match ;   Ez  (x=-10,y=  0,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/e_field-z\.y=0\,z=0, 20, 2) ; 5.32394630616809e-07
match ;   Ex  (x=  0,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-x\.x=0\,y=0, 30, 2) ; 1.27254148428615e-10

match ;   Ex  (x=  0,y=  0,z=-10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-x\.x=0\,y=0, 20, 2) ; -0.000305943121778989
match ;   Ex  (x=  0,y=  0,z= 10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-x\.x=0\,y=0, 40, 2) ; 0.00030592057040733

match ;   Ez  (x=  0,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.y=0\,z=0, 30, 2) ; -4.79099296580973e-07
match ;   Ez  (x= 10,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.y=0\,z=0, 40, 2) ; -8.19716184248093e-07

match ;   Ez  (x=  0,y=-10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.x=0\,z=0, 20, 2) ; 8.8301768959447e-05
match ;   Ez  (x=  0,y= 10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.x=0\,z=0, 40, 2) ; 8.84727401178529e-05

match ;   Ez  (x=  0,y=  0,z=-10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.x=0\,y=0, 20, 2) ; -4.90457499866281e-05
match ;   Ez  (x=  0,y=  0,z= 10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.x=0\,y=0, 40, 2) ; -4.90378598367536e-05

match ;   Bx  (x=  0,y=-10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-x\.x=0\,z=0, 20, 2) ; 4.46515025251023e-06
match ;   Bx  (x=  0,y= 10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-x\.x=0\,z=0, 40, 2) ; -4.46341892163888e-06

match ;   By  (x=-10,y=  0,z=  0) [step 10]   ; LINEFIELD(Maxwell/output_iter/td.0000010/b_field-y\.y=0\,z=0, 20, 2) ; -7.77006957398952e-09
match ;   Bx  (x=  0,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-x\.x=0\,z=0, 30, 2) ; 3.02466570493573e-13

Precision: 1.0e-15
match ;   Ez  (x=-10,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/e_field-z\.y=0\,z=0, 20, 2) ; -0.134021222029018

match ;   By  (x=-10,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.y=0\,z=0, 20, 2) ; 0.0019559997004613
match ;   By  (x=  0,y=-10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.x=0\,z=0, 20, 2) ; 7.1580815746355e-07

match ;   By  (x=  0,y= 10,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.x=0\,z=0, 40, 2) ; 7.17588834441779e-07
match ;   By  (x=  0,y=  0,z=-10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.x=0\,y=0, 20, 2) ; -1.28873897287466e-06

match ;   By  (x=  0,y=  0,z= 10) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.x=0\,y=0, 40, 2) ; -1.28906613544043e-06
match ;   By  (x= 10,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.y=0\,z=0, 40, 2) ; 1.19636210954554e-08
match ;   By  (x=  0,y=  0,z=  0) [step 30]   ; LINEFIELD(Maxwell/output_iter/td.0000030/b_field-y\.y=0\,z=0, 30, 2) ; 6.99291008363393e-09

else
  match ; Error cgal_not_linked        ; GREPCOUNT(err, 'CGAL'); 1
endif
