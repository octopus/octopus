# -*- coding: utf-8 mode: shell-script -*-

Test       : Carbon
Program    : octopus
TestGroups : long-run, finite_systems_3d
Enabled    : Yes

# The purpose of this test is making sure that spin-polarized
# calculations work.
# It is the calculation of one atom of Carbon, within the LSDA
# calculation.
#
# The result *almost* compares (to within 0.1eV) with the results
# given at the NIST webpage:
# http://physics.nist.gov/PhysRefData/DFTdata/contents.html
# The reasons for the discrepancy may be two:
# o The NIST calculation is all-electron.
# o The NIST calculation uses the VWN correlation. Here I have put
#   put PZ, because otherwise the results are even worse (probably
#   our VWN has some bug?)
# It would be nice to investigate the reason for the small
# discrepancy...
Input: 01-carbon_atom.01-psf_l0.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.74144572
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.461702
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ; 1.000000
match ; Eigenvalue [4down] ; GREPFIELD(static/info, '4   dn', 3) ; -3.682119
match ; Occupation [4down] ; GREPFIELD(static/info, '4   dn', 4) ; 0.000000

# Now we repeat the calculation but making use of the l=1 component
# of the pseudopotential to build the local component.
Input: 01-carbon_atom.02-psf_l1.inp
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.81362567
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.466513
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ; 1.000000
match ; Eigenvalue [4down] ; GREPFIELD(static/info, '4   dn', 3) ; -3.683360
match ; Occupation [4down] ; GREPFIELD(static/info, '4   dn', 4) ; 0.000000

#The same using double grid
Processors: 1
# double grid not implemented in parallel
Input: 01-carbon_atom.03-ground_state_double_grid.inp
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.66216092
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.418842
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ; 1.000000
match ; Eigenvalue [4down] ; GREPFIELD(static/info, '4   dn', 3) ; -3.694731
match ; Occupation [4down] ; GREPFIELD(static/info, '4   dn', 4) ; 0.000000

Processors: 2
Input: 01-carbon_atom.04-cpi.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.81452282
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.467194
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ; 1.000000
match ; Eigenvalue [4down] ; GREPFIELD(static/info, '4   dn', 3) ; -3.683530
match ; Occupation [4down] ; GREPFIELD(static/info, '4   dn', 4) ; 0.000000

Input: 01-carbon_atom.05-fhi.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -146.81452282
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.467194
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ; 1.000000
match ; Eigenvalue [4down] ; GREPFIELD(static/info, '4   dn', 3) ; -3.683530
match ; Occupation [4down] ; GREPFIELD(static/info, '4   dn', 4) ; 0.000000

Input: 01-carbon_atom.06-dojo_lda.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -155.35863440
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.452787
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ;   1.000000
match ; Eigenvalue   [1dn] ; GREPFIELD(static/info, '1   dn', 3) ; -11.813598
match ; Occupation   [1dn] ; GREPFIELD(static/info, '1   dn', 4) ;   1.000000
match ; Eigenvalue   [2up] ; GREPFIELD(static/info, '2   up', 3) ;  -6.191649
match ; Occupation   [2up] ; GREPFIELD(static/info, '2   up', 4) ;   0.666667
match ; Eigenvalue   [2dn] ; GREPFIELD(static/info, '2   dn', 3) ;  -3.801037
match ; Occupation   [2dn] ; GREPFIELD(static/info, '2   dn', 4) ;   0.000000
match ; Eigenvalue   [3up] ; GREPFIELD(static/info, '3   up', 3) ;  -6.191649
match ; Occupation   [3up] ; GREPFIELD(static/info, '3   up', 4) ;   0.666667
match ; Eigenvalue   [3dn] ; GREPFIELD(static/info, '3   dn', 3) ;  -3.801037
match ; Occupation   [3dn] ; GREPFIELD(static/info, '3   dn', 4) ;   0.000000
match ; Eigenvalue   [4up] ; GREPFIELD(static/info, '4   up', 3) ;  -6.191649
match ; Occupation   [4up] ; GREPFIELD(static/info, '4   up', 4) ;   0.666667
match ; Eigenvalue   [4dn] ; GREPFIELD(static/info, '4   dn', 3) ;  -3.801037
match ; Occupation   [4dn] ; GREPFIELD(static/info, '4   dn', 4) ;   0.000000

Input: 01-carbon_atom.07-dojo_pbe.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -156.14466362
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.651344
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ;   1.000000
match ; Eigenvalue   [1dn] ; GREPFIELD(static/info, '1   dn', 3) ; -11.709735
match ; Occupation   [1dn] ; GREPFIELD(static/info, '1   dn', 4) ;   1.000000
match ; Eigenvalue   [2up] ; GREPFIELD(static/info, '2   up', 3) ;  -6.137501
match ; Occupation   [2up] ; GREPFIELD(static/info, '2   up', 4) ;   0.666667
match ; Eigenvalue   [2dn] ; GREPFIELD(static/info, '2   dn', 3) ;  -3.481641
match ; Occupation   [2dn] ; GREPFIELD(static/info, '2   dn', 4) ;   0.000000
match ; Eigenvalue   [3up] ; GREPFIELD(static/info, '3   up', 3) ;  -6.137501
match ; Occupation   [3up] ; GREPFIELD(static/info, '3   up', 4) ;   0.666667
match ; Eigenvalue   [3dn] ; GREPFIELD(static/info, '3   dn', 3) ;  -3.481641
match ; Occupation   [3dn] ; GREPFIELD(static/info, '3   dn', 4) ;   0.000000
match ; Eigenvalue   [4up] ; GREPFIELD(static/info, '4   up', 3) ;  -6.137501
match ; Occupation   [4up] ; GREPFIELD(static/info, '4   up', 4) ;   0.666667
match ; Eigenvalue   [4dn] ; GREPFIELD(static/info, '4   dn', 3) ;  -3.481641
match ; Occupation   [4dn] ; GREPFIELD(static/info, '4   dn', 4) ;   0.000000

Input: 01-carbon_atom.08-dojo_pbesol.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -155.19847543
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ;  -14.529881
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ;    1.000000
match ; Eigenvalue   [1dn] ; GREPFIELD(static/info, '1   dn', 3) ;  -11.667288
match ; Occupation   [1dn] ; GREPFIELD(static/info, '1   dn', 4) ;    1.000000
match ; Eigenvalue   [2up] ; GREPFIELD(static/info, '2   up', 3) ;   -6.072458
match ; Occupation   [2up] ; GREPFIELD(static/info, '2   up', 4) ;    0.666667
match ; Eigenvalue   [2dn] ; GREPFIELD(static/info, '2   dn', 3) ;   -3.466888
match ; Occupation   [2dn] ; GREPFIELD(static/info, '2   dn', 4) ;    0.000000
match ; Eigenvalue   [3up] ; GREPFIELD(static/info, '3   up', 3) ;   -6.072458
match ; Occupation   [3up] ; GREPFIELD(static/info, '3   up', 4) ;    0.666667
match ; Eigenvalue   [3dn] ; GREPFIELD(static/info, '3   dn', 3) ;   -3.466888
match ; Occupation   [3dn] ; GREPFIELD(static/info, '3   dn', 4) ;    0.000000
match ; Eigenvalue   [4up] ; GREPFIELD(static/info, '4   up', 3) ;   -6.072458
match ; Occupation   [4up] ; GREPFIELD(static/info, '4   up', 4) ;    0.666667
match ; Eigenvalue   [4dn] ; GREPFIELD(static/info, '4   dn', 3) ;   -3.466888
match ; Occupation   [4dn] ; GREPFIELD(static/info, '4   dn', 4) ;    0.000000

ExtraFile  : 01-carbon_atom.pseudodojo.psml
Input: 01-carbon_atom.09-dojo_pbe_psml.inp
Precision: 0.00011
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ; -156.14453072
match ; Eigenvalue   [1up] ; GREPFIELD(static/info, '1   up', 3) ; -14.651319
match ; Occupation   [1up] ; GREPFIELD(static/info, '1   up', 4) ;   1.000000
match ; Eigenvalue   [1dn] ; GREPFIELD(static/info, '1   dn', 3) ; -11.709664
match ; Occupation   [1dn] ; GREPFIELD(static/info, '1   dn', 4) ;   1.000000
match ; Eigenvalue   [2up] ; GREPFIELD(static/info, '2   up', 3) ;  -6.137477
match ; Occupation   [2up] ; GREPFIELD(static/info, '2   up', 4) ;   0.666667
match ; Eigenvalue   [2dn] ; GREPFIELD(static/info, '2   dn', 3) ;  -3.481587
match ; Occupation   [2dn] ; GREPFIELD(static/info, '2   dn', 4) ;   0.000000
match ; Eigenvalue   [3up] ; GREPFIELD(static/info, '3   up', 3) ;  -6.137477
match ; Occupation   [3up] ; GREPFIELD(static/info, '3   up', 4) ;   0.666667
match ; Eigenvalue   [3dn] ; GREPFIELD(static/info, '3   dn', 3) ;  -3.481586
match ; Occupation   [3dn] ; GREPFIELD(static/info, '3   dn', 4) ;   0.000000
match ; Eigenvalue   [4up] ; GREPFIELD(static/info, '4   up', 3) ;  -6.137476
match ; Occupation   [4up] ; GREPFIELD(static/info, '4   up', 4) ;   0.666667
match ; Eigenvalue   [4dn] ; GREPFIELD(static/info, '4   dn', 3) ;  -3.481586
match ; Occupation   [4dn] ; GREPFIELD(static/info, '4   dn', 4) ;   0.000000
