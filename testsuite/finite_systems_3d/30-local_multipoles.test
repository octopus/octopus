# -*- coding: utf-8 mode: shell-script -*-

Test       : Local Multipoles analysis (ld)
Program    : octopus
TestGroups : short-run, finite_systems_3d
Enabled    : Yes

Input : 30-local_multipoles.01-gs.inp
match ; SCF convergence    ; GREPCOUNT(static/info, 'SCF converged') ; 1
match ; Total energy       ; GREPFIELD(static/info, 'Total       =', 3) ;    -219.01349875
match ; Partial charge  1  ; GREPFIELD(static/info, 'Partial ionic charges', 3, 2)  ; 4.273
match ; Partial charge  2  ; GREPFIELD(static/info, 'Partial ionic charges', 3, 3)  ; 0.932

Processors : 1
MPIUtil : oct-local_multipoles
Input : 30-local_multipoles.02-multipoles.inp

Precision: 1.00e-15
match ;  C  - Start Arrow  ; GREPFIELD(local.general/multipoles/C/C.0000000.bld, 'arrow', 2) ; 0.0
Precision: 1.00e-15
match ;  C  - End Arrow    ; GREPFIELD(local.general/multipoles/C/C.0000000.bld, 'arrow', 5) ; 0.0
Precision: 4.96e-16
match ;  H1 - Start Arrow  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 2) ; 0.495744
Precision: 8.90e-16
match ;  H1 - End Arrow    ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 5) ; 0.889897
Precision: 6.46e-16
match ;  H3 - Start Arrow  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 2) ; 0.646225
Precision: 7.39e-16
match ;  H3 - End Arrow    ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 5) ; 0.739416
Precision: 6.00e-15
match ;  Restart ld           ; GREPFIELD(restart/ld/ldomains.info, 'Number of local domains', 6) ; 6.0
Precision: 5.12e-13
match ;  C  - Restart shape   ; GREPFIELD(restart/ld/ldomains.info, 'C', 3) ; 512.0
Precision: 1.00e-15
match ;  H1 - Restart shape   ; GREPFIELD(restart/ld/ldomains.info, 'H1', 3) ; 1.0
Precision: 1.00e-15
match ;  H2 - Restart shape   ; GREPFIELD(restart/ld/ldomains.info, 'H2', 3) ; 1.0
Precision: 4.00e-15
match ;  H3 - Restart shape   ; GREPFIELD(restart/ld/ldomains.info, 'H3', 3) ; 4.0
Precision: 2.00e-15
match ;  H4 - Restart shape   ; GREPFIELD(restart/ld/ldomains.info, 'H4', 3) ; 2.0
Precision: 4.27e-15
match ;  C    Electrons    ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 3) ; 4.268485630129
Precision: 2.02e-15
match ;  C    Multipole x  ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 4) ; -7.803521339010001e-16
Precision: 2.17e-15
match ;  C    Multipole y  ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 5) ; 9.450891148085e-16
Precision: 9.60e-16
match ;  C    Multipole z  ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 6) ; -6.8606144869185e-16
Precision: 1.85e-15
match ;  H1   Electrons    ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 3) ; 1.853409258346
Precision: 3.94e-16
match ;  H1   Multipole x  ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 4) ; 0.3941528469568
Precision: 3.94e-16
match ;  H1   Multipole y  ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 5) ; 0.3941528469568
Precision: 3.94e-16
match ;  H1   Multipole z  ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 6) ; 0.3941528469568
Precision: 1.85e-15
match ;  H2   Electrons    ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 3) ; 1.853409258346
Precision: 3.94e-16
match ;  H2   Multipole x  ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 4) ; -0.3941528469568
Precision: 3.94e-16
match ;  H2   Multipole y  ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 5) ; -0.3941528469568
Precision: 3.94e-16
match ;  H2   Multipole z  ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 6) ; 0.3941528469568
Precision: 8.37e-16
match ;  H3   Electrons    ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 3) ; 0.8374820961336
Precision: 9.32e-17
match ;  H3   Multipole x  ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 4) ; 0.09319080543438
Precision: 9.32e-17
match ;  H3   Multipole y  ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 5) ; -0.09319080543438
Precision: 9.32e-17
match ;  H3   Multipole z  ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 6) ; -0.09319080543438
Precision: 7.46e-16
match ;  H4   Electrons    ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 3) ; 0.7459497761997
Precision: 7.83e-17
match ;  H4   Multipole x  ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 4) ; -0.07825945392033
Precision: 6.90e-17
match ;  H4   Multipole y  ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 5) ; 0.06903236179386
Precision: 6.90e-17
match ;  H4   Multipole z  ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 6) ; -0.06903236179386
Precision: 5.31e-15
match ;  H2-4 Electrons    ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 3) ; 5.310119139299
Precision: 3.86e-16
match ;  H2-4 Multipole x  ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 4) ; -0.3863065161116
Precision: 3.86e-16
match ;  H2-4 Multipole y  ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 5) ; -0.3863065161116
Precision: 3.86e-16
match ;  H2-4 Multipole z  ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 6) ; -0.3863065161116
Precision: 4.96e-16
match ;  H1 Start Arrow y  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 3) ; 0.495744
Precision: 4.96e-16
match ;  H1 Start Arrow z  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 4) ; 0.495744
Precision: 8.90e-16
match ;  H1 End Arrow   y  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 6) ; 0.889897
Precision: 8.90e-16
match ;  H1 End Arrow   z  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 7) ; 0.889897
Precision: 6.46e-16
match ;  H3 Start Arrow y  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 3) ; -0.646225
Precision: 6.46e-16
match ;  H3 Start Arrow z  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 4) ; -0.646225
Precision: 7.39e-16
match ;  H3 End Arrow   y  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 6) ; -0.739416
Precision: 7.39e-16
match ;  H3 End Arrow   z  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 7) ; -0.739416
Precision: 3.78e-17
match ;  H2-4 Start Arrow x  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 2) ; -0.037787
Precision: 3.78e-17
match ;  H2-4 Start Arrow y  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 3) ; -0.037787
Precision: 3.78e-17
match ;  H2-4 Start Arrow z  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 4) ; -0.037787
Precision: 4.24e-16
match ;  H2-4 End Arrow   x  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 5) ; -0.424093
Precision: 4.24e-16
match ;  H2-4 End Arrow   y  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 6) ; -0.424093
Precision: 4.24e-16
match ;  H2-4 End Arrow   z  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 7) ; -0.424093
Precision: 3.00e-15
match ;  H2-4 Restart shape      ; GREPFIELD(restart/ld/ldomains.info, 'H2-4', 3) ; 3.0


# Recalculate the same local quantities, but this time using the local domains restart information.
# The results should be identical to the ones above.
Input : 30-local_multipoles.03-multipoles_restart.inp

Precision: 4.27e-15
match ;   C    Electrons     ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 3) ; 4.268485630129
Precision: 2.02e-15
match ;   C    Multipole x   ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 4) ; -7.803521339010001e-16
Precision: 2.17e-15
match ;   C    Multipole y   ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 5) ; 9.450891148085e-16
Precision: 9.60e-16
match ;   C    Multipole z   ; LINEFIELD(local.general/multipoles/C.multipoles, -1, 6) ; -6.8606144869185e-16
Precision: 1.85e-15
match ;   H1   Electrons     ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 3) ; 1.853409258346
Precision: 3.94e-16
match ;   H1   Multipole x   ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 4) ; 0.3941528469568
Precision: 3.94e-16
match ;   H1   Multipole y   ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 5) ; 0.3941528469568
Precision: 3.94e-16
match ;   H1   Multipole z   ; LINEFIELD(local.general/multipoles/H1.multipoles, -1, 6) ; 0.3941528469568
Precision: 1.85e-15
match ;   H2   Electrons     ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 3) ; 1.853409258346
Precision: 3.94e-16
match ;   H2   Multipole x   ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 4) ; -0.3941528469568
Precision: 3.94e-16
match ;   H2   Multipole y   ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 5) ; -0.3941528469568
Precision: 3.94e-16
match ;   H2   Multipole z   ; LINEFIELD(local.general/multipoles/H2.multipoles, -1, 6) ; 0.3941528469568
Precision: 8.37e-16
match ;   H3   Electrons     ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 3) ; 0.8374820961336
Precision: 9.32e-17
match ;   H3   Multipole x   ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 4) ; 0.09319080543438
Precision: 9.32e-17
match ;   H3   Multipole y   ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 5) ; -0.09319080543438
Precision: 9.32e-17
match ;   H3   Multipole z   ; LINEFIELD(local.general/multipoles/H3.multipoles, -1, 6) ; -0.09319080543438
Precision: 7.46e-16
match ;   H4   Electrons     ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 3) ; 0.7459497761997
Precision: 7.83e-17
match ;   H4   Multipole x   ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 4) ; -0.07825945392033
Precision: 6.90e-17
match ;   H4   Multipole y   ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 5) ; 0.06903236179386
Precision: 6.90e-17
match ;   H4   Multipole z   ; LINEFIELD(local.general/multipoles/H4.multipoles, -1, 6) ; -0.06903236179386
Precision: 5.31e-15
match ;   H2-4 Electrons     ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 3) ; 5.310119139299
Precision: 3.86e-16
match ;   H2-4 Multipole x   ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 4) ; -0.3863065161116
Precision: 3.86e-16
match ;   H2-4 Multipole y   ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 5) ; -0.3863065161116
Precision: 3.86e-16
match ;   H2-4 Multipole z   ; LINEFIELD(local.general/multipoles/H2-4.multipoles, -1, 6) ; -0.3863065161116
Precision: 1.00e-15
match ;  C  Start Arrow x  ; GREPFIELD(local.general/multipoles/C/C.0000000.bld, 'arrow', 2) ; 0.0
Precision: 1.00e-15
match ;  C  End Arrow   x  ; GREPFIELD(local.general/multipoles/C/C.0000000.bld, 'arrow', 5) ; 0.0
Precision: 4.96e-16
match ;  H1 Start Arrow x  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 2) ; 0.495744
Precision: 4.96e-16
match ;  H1 Start Arrow y  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 3) ; 0.495744
Precision: 4.96e-16
match ;  H1 Start Arrow z  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 4) ; 0.495744
Precision: 8.90e-16
match ;  H1 End Arrow   x  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 5) ; 0.889897
Precision: 8.90e-16
match ;  H1 End Arrow   y  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 6) ; 0.889897
Precision: 8.90e-16
match ;  H1 End Arrow   z  ; GREPFIELD(local.general/multipoles/H1/H1.0000000.bld, 'arrow', 7) ; 0.889897
Precision: 6.46e-16
match ;  H3 Start Arrow x  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 2) ; 0.646225
Precision: 6.46e-16
match ;  H3 Start Arrow y  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 3) ; -0.646225
Precision: 6.46e-16
match ;  H3 Start Arrow z  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 4) ; -0.646225
Precision: 7.39e-16
match ;  H3 End Arrow   x  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 5) ; 0.739416
Precision: 7.39e-16
match ;  H3 End Arrow   y  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 6) ; -0.739416
Precision: 7.39e-16
match ;  H3 End Arrow   z  ; GREPFIELD(local.general/multipoles/H3/H3.0000000.bld, 'arrow', 7) ; -0.739416
Precision: 3.78e-17
match ;  H2-4 Start Arrow x  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 2) ; -0.037787
Precision: 3.78e-17
match ;  H2-4 Start Arrow y  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 3) ; -0.037787
Precision: 3.78e-17
match ;  H2-4 Start Arrow z  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 4) ; -0.037787
Precision: 4.24e-16
match ;  H2-4 End Arrow   x  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 5) ; -0.424093
Precision: 4.24e-16
match ;  H2-4 End Arrow   y  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 6) ; -0.424093
Precision: 4.24e-16
match ;  H2-4 End Arrow   z  ; GREPFIELD(local.general/multipoles/H2-4/H2-4.0000000.bld, 'arrow', 7) ; -0.424093
