# -*- coding: utf-8 mode: shell-script -*-

Test       : DFTB+ API
Program    : octopus
TestGroups : short-run, components
Enabled    : Yes

ExtraFile : H-H.skf
ExtraFile : H-O.skf
ExtraFile : O-H.skf
ExtraFile : O-O.skf
Input: 31-dftbplus.01-example.inp

if (available DFTBPlus); then
  match ; Mermin Energy ; GREPFIELD(out, 'Mermin Energy', 4)  ; -3.9854803392
  match ; Gross charge 1 ; GREPFIELD(out, 'gross charges', 4)  ; -0.4943983279
  match ; Gross charge 2 ; GREPFIELD(out, 'gross charges', 5)  ; 0.2641722128
  match ; Gross charge 3 ; GREPFIELD(out, 'gross charges', 6)  ; 0.2302261151
  match ; Atom 1 gradient x ; GREPFIELD(out, 'gradient of atom 1', 6)  ; 0.0176513638
  match ; Atom 1 gradient y ; GREPFIELD(out, 'gradient of atom 1', 7)  ; -0.1831376018
  match ; Atom 1 gradient z ; GREPFIELD(out, 'gradient of atom 1', 8)  ; 0.0031982515
  match ; Atom 2 gradient x ; GREPFIELD(out, 'gradient of atom 2', 6)  ; -0.0061402266
  match ; Atom 2 gradient y ; GREPFIELD(out, 'gradient of atom 2', 7)  ; 0.0955090293
  match ; Atom 2 gradient z ; GREPFIELD(out, 'gradient of atom 2', 8)  ; 0.0394035230
  match ; Atom 3 gradient x ; GREPFIELD(out, 'gradient of atom 3', 6)  ; -0.0037720260
  match ; Atom 3 gradient y ; GREPFIELD(out, 'gradient of atom 3', 7)  ; 0.0923535862
  match ; Atom 3 gradient z ; GREPFIELD(out, 'gradient of atom 3', 8)  ; -0.0402979580
  match ; Charge 1 gradient x ; GREPFIELD(out, 'gradient of charge 1', 6)  ; 0.0011862359
  match ; Charge 1 gradient y ; GREPFIELD(out, 'gradient of charge 1', 7)  ; 0.0069504533
  match ; Charge 1 gradient z ; GREPFIELD(out, 'gradient of charge 1', 8)  ; -0.0024276112
  match ; Charge 2 gradient x ; GREPFIELD(out, 'gradient of charge 2', 6)  ; 0.0065528753
  match ; Charge 2 gradient y ; GREPFIELD(out, 'gradient of charge 2', 7)  ; -0.0022254395
  match ; Charge 2 gradient z ; GREPFIELD(out, 'gradient of charge 2', 8)  ; 0.0047314278
else
  match ; Error dftbplus_not_linked ; GREPCOUNT(err, 'DFTB+ API'); 1
endif

