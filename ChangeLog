2008-12-30 14:10  xavier

	* [r4846] src/grid/derivatives.F90, src/grid/mesh.F90,
	  src/grid/mesh_function_inc.F90, src/grid/ob_interface.F90,
	  src/hamiltonian/rkb_projector.F90, src/ions/dynamics.F90,
	  src/states/restart.F90: Removed some unused variables.

2009-01-02 17:18  acastro

	* [r4847] src/grid/mesh_function.F90,
	  src/grid/mesh_function_inc.F90, src/states/states.F90: Separated
	  the calculations of the density matrix, which is transferred
	  to mesh_function module, from its printout. Also, now it does not
	  break in the parallel case as before.

2009-01-05 10:41  marques

	* [r4848] libxc/DONE, libxc/TODO, libxc/src/Makefile.am,
	  libxc/src/gga_x_bayesian.c: Added a new form for the exachange
	  enhancement factor that comes from a bayesian best fit procedure

2009-01-05 10:48  marques

	* [r4849] src/grid/mesh_function_inc.F90, src/xc/xc.F90: Needed an
	  #ifdef to compile

2009-01-05 12:36  marques

	* [r4850] src/main/one_shot.F90, src/system/v_ks.F90,
	  src/system/xc_OEP_inc.F90: Now also orbital functionals work in
	  the one_shot mode

2009-01-05 20:48  acastro

	* [r4851] src/grid/mesh_function.F90,
	  src/grid/mesh_function_inc.F90, src/states/states.F90: o Removed
	  some problems that appeared when computing the density
	  matrix in parallel.
	  
	  o Now the computation of the density matrix uses the
	  cube_function_m
	  module, which makes it easier, and hopefully easier to generalize
	  to
	  higher dimension.

2009-01-08 23:31  dstrubbe

	* [r4852] src/basic/loct_parser.F90, src/ions/simul_box.F90,
	  src/math/fft.F90, src/utils/dielectric_function.F90: A point of
	  spelling: replaced "can not" with "cannot"

2009-01-09 16:11  xavier

	* [r4853] src/grid/grid.F90, src/grid/mesh_function_inc.F90,
	  src/grid/par_vec.F90, src/hamiltonian/epot.F90,
	  src/hamiltonian/gauge_field.F90, src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/lasers_inc.F90,
	  src/hamiltonian/projector_inc.F90,
	  src/hamiltonian/species_pot.F90, src/include/global.h,
	  src/main/casida.F90, src/main/casida_inc.F90, src/main/gcm.F90,
	  src/main/geom_opt.F90, src/main/one_shot.F90,
	  src/main/phonons_fd.F90, src/main/static_pol.F90,
	  src/main/unocc.F90, src/main/unocc_inc.F90,
	  src/opt_control/defstates.F90, src/opt_control/opt_control.F90,
	  src/opt_control/propagation.F90, src/opt_control/target.F90,
	  src/poisson/poisson.F90, src/poisson/solver_3D.F90,
	  src/poisson/solver_fft.F90, src/poisson/solver_multigrid.F90,
	  src/scf/eigen_cg_inc.F90, src/scf/eigen_evolution_inc.F90,
	  src/scf/eigen_lobpcg_inc.F90, src/scf/eigen_mg_inc.F90,
	  src/scf/eigen_plan_inc.F90, src/scf/eigen_rmmdiis_inc.F90,
	  src/scf/ground_state.F90, src/scf/lcao_inc.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/scf/scf.F90,
	  src/scf/subspace_inc.F90, src/states/elf.F90,
	  src/states/restart.F90, src/states/restart_inc.F90,
	  src/states/states.F90, src/states/states_calc_inc.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/em_resp_calc.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/kdotp_calc.F90, src/sternheimer/phonons_lr.F90,
	  src/sternheimer/raman.F90, src/sternheimer/sternheimer.F90,
	  src/sternheimer/sternheimer_inc.F90, src/sternheimer/vdW.F90,
	  src/system/energy_inc.F90, src/system/exponential.F90,
	  src/system/exponential_split.F90,
	  src/system/linear_solver_inc.F90, src/system/output_h_sys.F90,
	  src/system/output_linear_response.F90,
	  src/system/output_states.F90, src/system/pert_inc.F90,
	  src/system/preconditioners.F90, src/system/system.F90,
	  src/system/v_ks.F90, src/system/xc_OEP_SIC_inc.F90,
	  src/system/xc_OEP_inc.F90, src/system/xc_OEP_kernel_inc.F90,
	  src/system/xc_OEP_x_inc.F90, src/td/cpmd.F90,
	  src/td/cpmd_inc.F90, src/td/ob_rti.F90, src/td/td.F90,
	  src/td/td_calc.F90, src/td/td_init.F90, src/td/td_rti.F90,
	  src/td/td_write.F90, src/xc/axc.F90, src/xc/vxc.F90: Renamed gr%m
	  to gr%mesh.

2009-01-09 16:19  xavier

	* [r4854] src/hamiltonian/epot.F90, src/scf/eigen.F90,
	  src/scf/ground_state.F90, src/scf/lcao.F90,
	  src/states/linear_response.F90, src/states/states.F90,
	  src/states/states_calc.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90, src/td/cpmd.F90, src/td/td.F90:
	  Renamed wfs_are_real to states_are_real (the same for
	  wfs_are_complex).

2009-01-09 17:03  xavier

	* [r4855] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/main/gcm.F90,
	  src/main/unocc.F90, src/scf/eigen_cg_inc.F90,
	  src/scf/eigen_evolution_inc.F90, src/scf/eigen_lobpcg_inc.F90,
	  src/scf/eigen_mg_inc.F90, src/scf/eigen_plan_inc.F90,
	  src/scf/eigen_rmmdiis_inc.F90, src/scf/lcao_inc.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/scf/subspace_inc.F90,
	  src/system/energy_inc.F90, src/system/exponential.F90,
	  src/system/linear_solver_inc.F90, src/td/cpmd_inc.F90,
	  src/td/ob_rti.F90, src/td/td_calc.F90: * Renamed hpsi to
	  hamiltonian_apply.

2009-01-09 22:07  xavier

	* [r4856] src/basic/global.F90, src/include/global.h,
	  src/td/ob_mem.F90: Now M_ONE and M_ZERO are macros. This should
	  allow the compiler to
	  optimize more the code.

2009-01-10 12:22  xavier

	* [r4857] src/basic/datasets.F90, src/basic/multicomm.F90,
	  src/basic/units.F90, src/grid/curv_briggs.F90,
	  src/grid/curv_gygi.F90, src/grid/curv_modine.F90,
	  src/grid/curvlinear.F90, src/grid/derivatives.F90,
	  src/grid/double_grid.F90, src/grid/grid.F90,
	  src/grid/io_function.F90, src/grid/mesh_init.F90,
	  src/grid/multigrid.F90, src/grid/scalar_mesh.F90,
	  src/hamiltonian/epot.F90, src/hamiltonian/gauge_field.F90,
	  src/hamiltonian/hamiltonian.F90, src/hamiltonian/lasers.F90,
	  src/hamiltonian/scf_tol.F90, src/hamiltonian/species_pot.F90,
	  src/ions/dynamics.F90, src/ions/geometry.F90,
	  src/ions/simul_box.F90, src/ions/xyz_adjust.F90,
	  src/ions/xyz_file.F90, src/main/casida.F90, src/main/gcm.F90,
	  src/main/geom_opt.F90, src/main/main.F90,
	  src/main/phonons_fd.F90, src/main/run.F90,
	  src/main/static_pol.F90, src/main/test.F90, src/main/unocc.F90,
	  src/math/fftw3.F90, src/math/ode_solver_inc.F90,
	  src/math/root_solver.F90, src/math/sparskit_inc.F90,
	  src/math/tdfunction.F90, src/opt_control/defstates.F90,
	  src/opt_control/filters.F90, src/opt_control/iter.F90,
	  src/opt_control/parameters.F90, src/opt_control/read.F90,
	  src/opt_control/target.F90, src/poisson/poisson.F90,
	  src/poisson/solver_3D.F90, src/poisson/solver_fft.F90,
	  src/poisson/solver_multigrid.F90, src/scf/eigen.F90,
	  src/scf/ground_state.F90, src/scf/lcao.F90, src/scf/scf.F90,
	  src/species/ps.F90, src/species/species.F90, src/states/elf.F90,
	  src/states/mix.F90, src/states/restart.F90, src/states/smear.F90,
	  src/states/states.F90, src/states/states_calc.F90,
	  src/states/states_kpoints.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90, src/sternheimer/sternheimer.F90,
	  src/sternheimer/vdW.F90, src/system/exponential.F90,
	  src/system/linear_solver.F90, src/system/output_h_sys.F90,
	  src/system/pert.F90, src/system/preconditioners.F90,
	  src/system/v_ks.F90, src/system/xc_OEP.F90, src/td/cpmd.F90,
	  src/td/ob_mem.F90, src/td/ob_rti.F90, src/td/pes.F90,
	  src/td/pes_rc.F90, src/td/spectrum.F90, src/td/td.F90,
	  src/td/td_init.F90, src/td/td_rti.F90, src/td/td_write.F90,
	  src/utils/broad.F90, src/utils/dielectric_function.F90,
	  src/utils/harmonic_spectrum.F90, src/utils/phonon_spectrum.F90,
	  src/utils/xyzanim.F90, src/xc/functionals.F90, src/xc/xc.F90:
	  Renamed check_inp to datasets_check.

2009-01-10 16:07  xavier

	* [r4858] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/main/casida.F90,
	  src/main/gcm.F90, src/main/geom_opt.F90, src/main/one_shot.F90,
	  src/main/phonons_fd.F90, src/main/run.F90,
	  src/main/static_pol.F90, src/main/unocc.F90,
	  src/main/unocc_inc.F90, src/opt_control/finalcheck.F90,
	  src/opt_control/opt_control.F90, src/opt_control/propagation.F90,
	  src/opt_control/read.F90, src/scf/eigen.F90,
	  src/scf/eigen_cg_inc.F90, src/scf/eigen_evolution_inc.F90,
	  src/scf/eigen_lobpcg_inc.F90, src/scf/eigen_mg_inc.F90,
	  src/scf/eigen_plan_inc.F90, src/scf/eigen_rmmdiis_inc.F90,
	  src/scf/ground_state.F90, src/scf/lcao.F90, src/scf/lcao_inc.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/scf/scf.F90,
	  src/scf/subspace_inc.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/kdotp_calc.F90, src/sternheimer/phonons_lr.F90,
	  src/sternheimer/raman.F90, src/sternheimer/sternheimer.F90,
	  src/sternheimer/sternheimer_inc.F90, src/sternheimer/vdW.F90,
	  src/system/energy.F90, src/system/energy_inc.F90,
	  src/system/exponential.F90, src/system/exponential_split.F90,
	  src/system/linear_solver.F90, src/system/linear_solver_inc.F90,
	  src/system/output_h.F90, src/system/output_h_sys.F90,
	  src/system/pert_inc.F90, src/system/preconditioners_inc.F90,
	  src/system/system.F90, src/system/v_ks.F90,
	  src/system/xc_OEP_inc.F90, src/system/xc_OEP_kernel_inc.F90,
	  src/td/cpmd_inc.F90, src/td/ob_mem.F90, src/td/ob_rti.F90,
	  src/td/td.F90, src/td/td_calc.F90, src/td/td_init.F90,
	  src/td/td_rti.F90, src/td/td_write.F90: Renamed the hamiltonian
	  object from h to hm.

2009-01-10 20:08  xavier

	* [r4859] src/basic/profiling.F90, src/grid/mesh_function.F90,
	  src/grid/mesh_function_inc.F90, src/grid/par_vec.F90,
	  src/grid/par_vec_inc.F90, src/hamiltonian/hamiltonian_inc.F90,
	  src/scf/eigen.F90, src/scf/lcao.F90, src/scf/scf.F90,
	  src/td/td.F90: Moved some profiling variables to their own
	  modules.

2009-01-10 20:38  xavier

	* [r4860] src/grid/derivatives_inc.F90, src/grid/mesh.F90,
	  src/grid/mesh_init.F90, src/grid/par_vec.F90,
	  src/grid/par_vec_inc.F90, src/grid/submesh.F90,
	  src/grid/submesh_inc.F90: Renamed vp%p to vp%npart.

2009-01-11 10:38  xavier

	* [r4861] configure.ac: Removed some whitespaces that might produce
	  problems with autoconf.

2009-01-11 22:28  xavier

	* [r4862] src/main/main.F90, src/main/run.F90: Renamed run_prog_m
	  to run_m.

2009-01-13 08:24  marques

	* [r4863] configure.ac, src/beak/beak.h: Some compilers (pathscale)
	  did not implement SSE, even if the header
	  file is available. These changes now allow octopus to compile in
	  milipeia
	  
	  BTW, Xavier, the file operate_ri_vec.c gives lots of warnings,
	  and the
	  code accesses directly the type __m128d, which the manual says
	  one
	  should not do... is it possible to clean it?

2009-01-13 10:22  xavier

	* [r4864] src/beak/operate_ri_vec.c: The SSE code was doing some
	  ilegal (but correct) pointer castings.

2009-01-14 11:39  xavier

	* [r4865] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/main/phonons_fd.F90,
	  src/main/run.F90, src/main/static_pol.F90, src/scf/scf.F90,
	  src/system/v_ks.F90, src/td/td.F90, src/td/td_rti.F90: Now the
	  hamiltonian stores the total potential, this saves time and
	  simplifies the routine to apply the hamiltonian. The price to pay
	  is
	  that hamiltonian_update_potential must be called each time
	  hm%vpsl or
	  hm%vhxc are changed.

2009-01-14 23:21  xavier

	* [r4866] src/hamiltonian/Makefile.am,
	  src/hamiltonian/em_field.F90, src/hamiltonian/em_field_inc.F90,
	  src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90: Added a new object,
	  em_field_t, that stores an electromagnetic field
	  and can apply it over a wave-function.

2009-01-15 18:03  xavier

	* [r4867] src/hamiltonian/Makefile.am, src/hamiltonian/lasers.F90:
	  Added a function to generate a em_field from a laser.

2009-01-15 18:55  xavier

	* [r4868] src/hamiltonian/em_field.F90,
	  src/hamiltonian/em_field_inc.F90, src/hamiltonian/lasers.F90:
	  Removed the uniform vector potential from em_field. Since the
	  idea is
	  to finally handle it through a phase, there is no need to have
	  it.

2009-01-15 20:07  xavier

	* [r4869] src/hamiltonian/lasers.F90: A couple of line were too
	  long.

2009-01-16 10:07  acastro

	* [r4870] src/opt_control/opt_control.F90: The code did not compile
	  if the newuoa library was present, due to the
	  change of name of the hamiltonian variable.

2009-01-16 11:38  xavier

	* [r4871] src/hamiltonian/em_field.F90,
	  src/hamiltonian/em_field_inc.F90: Added a function to apply an
	  em_field to a single function.

2009-01-17 02:53  dstrubbe

	* [r4872] src/states/states_dim.F90, src/states/states_kpoints.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/kdotp.F90: *) Made a
	  preprocessor variable for the name of the output directory for
	  kdotp and em_resp
	  *) Added a function kpoint_index that tells what number k-point
	  (without spin) a given ik refers to
	  *) Made kdotp use states_dim_get_spin_index and kpoint_index in
	  naming output files

2009-01-17 03:20  dstrubbe

	* [r4873] src/main/run.F90, src/main/static_pol.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/vdW.F90: Renamed pol_lr module to em_resp for
	  consistently with the filename.

2009-01-17 21:12  xavier

	* [r4874] src/td/td_rti.F90: Initial implementation of the Visscher
	  propagator, for the moment it
	  can only propagate a time independent hamiltonian.

2009-01-17 22:30  xavier

	* [r4875] src/td/td_rti.F90: Now the Visscher propagator works for
	  time dependent Hamiltonians.
	  
	  This is a nice scheme that only requires two real applications of
	  the
	  Hamiltonian per time step.

2009-01-17 23:30  xavier

	* [r4876] src/td/td_rti.F90,
	  testsuite/real_time/07-visscher.01-gs.inp,
	  testsuite/real_time/07-visscher.02-td.inp,
	  testsuite/real_time/07-visscher.test: * Added a test for the
	  visscher propagator. The results agree with
	  other propagators.

2009-01-18 09:02  dstrubbe

	* [r4877] src/main/casida.F90, src/opt_control/defstates.F90,
	  src/opt_control/target.F90, src/states/restart.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/phonons_lr.F90, src/sternheimer/raman.F90,
	  src/sternheimer/vdW.F90, src/td/td.F90: *) Combined routine
	  "read_wfs" which appeared in several copies in the Sternheimer
	  modules with the almost identical routine
	  "restart_look_and_read." Now an error will be generated when no
	  wavefunctions are found, which was not the case in most places
	  from which "restart_look_and_read" was called.
	  
	  I notice that Raman and phonons explicitly set the wavefunctions
	  to be real. Why is this? Shouldn't they be complex for a periodic
	  system?

2009-01-18 09:06  xavier

	* [r4878] src/td/td_rti.F90: * Now the exponential midpoint rule is
	  used to propagate the initial
	  imaginary part in the Visscher propagator.
	  * Some optimizations.

2009-01-20 01:39  dstrubbe

	* [r4879] src/sternheimer/phonons_lr.F90,
	  src/sternheimer/raman.F90: Now raman and phonon calculations
	  don't require ground-state wavefunctions to be real.

2009-01-20 02:40  acastro

	* [r4880] src/opt_control/defstates.F90,
	  src/opt_control/target.F90: Bug fix; the optimal control tests
	  were failing since the change in
	  the "restart_look_and_read" routine.

2009-01-20 20:58  dstrubbe

	* [r4881] src/main/casida.F90, src/states/restart.F90,
	  src/td/td.F90: Fixed the problem Alberto pointed out in two other
	  places too: the specify_dir optional argument is not used, since
	  in the old version of the routine the corresponding argument was
	  ignored.

2009-01-20 21:55  dstrubbe

	* [r4882] src/include/global.h, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90, src/sternheimer/phonons_lr.F90,
	  src/sternheimer/raman.F90, src/sternheimer/vdW.F90: Created
	  preprocessor constants in global.h for each Sternheimer routine's
	  restart directory, so those that use other routines' restart info
	  can be sure to be getting it from the same place it was put. This
	  may not be the best way to do it; let me know if you have a
	  better suggestion.

2009-01-20 22:18  dstrubbe

	* [r4883] src/sternheimer/em_resp.F90: Fix to last commit in which
	  I forgot to replace RESTART_DIR in em_resp.F90, which had caused
	  a test to fail.

2009-01-21 00:47  dstrubbe

	* [r4884] src/sternheimer/Makefile.am, src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/kdotp_calc.F90, src/sternheimer/raman.F90: *)
	  Reorganized kdotp and em_resp modules so that you first do a
	  kdotp run, then do an em_resp run. This way it is much easier to
	  do multiple frequencies, and removes a lot of duplicated code.
	  The calculation of alpha and beta will occur within the em_resp
	  run even for a periodic system.
	  *) Moved calculation of polarizability of periodic system to
	  em_resp_calc
	  *) Added variable to force calculation of alpha and beta without
	  kdotp wfns, as though it were a finite system.
	  *) Repeated "use" statement in raman.F90 removed.

2009-01-21 01:15  dstrubbe

	* [r4885] src/sternheimer/em_resp.F90: *) A small fix to a compiler
	  portability issue (can't use NDIM in declaration)
	  *) "Info: calculating response for direction..." is only printed
	  when it is necessary to do that calculation.

2009-01-21 14:35  acastro

	* [r4886] src/td/td_rti.F90: Bug fix; the code was crashing when
	  attempting to perform an
	  "associated" call over an uninitialized pointer.

2009-01-21 15:32  marques

	* [r4887] src/poisson/poisson.F90, src/poisson/solver_1D.F90,
	  src/poisson/solver_fft.F90: Added the possibility of changing the
	  parameter a (v=1/sqrt(a^2+x^2) in
	  the soft coulomb interaction in 1d. Alberto, was it you who
	  implemented
	  the periodic FFT solver in 1D? Can you please check if the
	  formula I
	  implemented is correct?

2009-01-21 17:56  acastro

	* [r4888] external_libs/newuoa/Makefile.am,
	  external_libs/newuoa/bigden.f90, external_libs/newuoa/biglag.f90,
	  external_libs/newuoa/newuoa.f90,
	  external_libs/newuoa/newuoa_mod.f90,
	  external_libs/newuoa/newuob.f90, external_libs/newuoa/trsapp.f90,
	  external_libs/newuoa/update.f90, src/common-rules.make,
	  src/opt_control/opt_control.F90: I put together all the
	  subroutines of the newuoa library into one
	  module; that way their names cannot collide with other parts of
	  the
	  code (except for only one public entity, and only if the module
	  is
	  used).

2009-01-22 03:46  dstrubbe

	* [r4889] src/sternheimer/sternheimer.F90,
	  src/system/linear_solver.F90, src/td/ob_rti.F90,
	  testsuite/linear_response/02-h2o_pol_lr.test: *) Changed default
	  Sternheimer solver to QMR instead of bicgstab.
	  *) By default preorthogonalization of wavefunctions against
	  occupied states is now done at the start of each Sternheimer SCF
	  cycle.
	  *) Changed test reference data since these alter results
	  slightly.
	  QMR and preorthogonalization make calculations converge better in
	  general, though they may take more time. This is why I have made
	  them default. For kdotp in particular the calculation does not
	  converge at all without these settings.
	  *) A few typographic issues in ob_rti.F90

2009-01-22 07:12  acastro

	* [r4890] src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90: Added a subroutine that provides
	  the upper and lower bounds of the
	  parameters that define the control functions for OCT.

2009-01-22 15:48  xavier

	* [r4891] src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/sternheimer/vdW.F90: A
	  function name was too long (stupid fortran limitation).

2009-01-23 23:20  dstrubbe

	* [r4892] src/states/restart.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90: *) Reading ground-state wavefunctions
	  must come before reading linear-response wavefunctions in em_resp
	  *) Slight improvement to formatting of warnings in kdotp and
	  em_resp
	  *) Renamed asserted variables to more meaningful things in
	  restart
	  *) Made output message give more info in restart

2009-01-25 09:22  xavier

	* [r4893] src/basic/calc_mode.F90, src/grid/mesh.F90,
	  src/main/Makefile.am, src/main/main.F90, src/main/run.F90,
	  src/states/states.F90: Added a new calculation mode: "memory".
	  
	  It tells you how much memory octopus will require to run.

2009-01-25 09:44  xavier

	* [r4894] src/main/memory.F90: Forgot to add a file.

2009-01-25 11:39  acastro

	* [r4895] src/td/td.F90, src/td/td_init.F90: All tests in
	  testsuite/real_time directory were failing, due to bad
	  usage of intent(out) in td_init.

2009-01-25 22:32  acastro

	* [r4896] src/opt_control/Makefile.am,
	  src/opt_control/defstates.F90, src/opt_control/filters.F90,
	  src/opt_control/initst.F90, src/opt_control/opt_control.F90,
	  src/opt_control/opt_control_constants.F90,
	  src/opt_control/target.F90: The definition of the initial state
	  (for the OCT runs) is done now in
	  its own module.

2009-01-26 09:24  marques

	* [r4897] src/main/unocc.F90, src/scf/eigen.F90,
	  src/scf/eigen_cg_inc.F90, src/scf/lcao_inc.F90: *) As discussed
	  in the mailing list, now unocc goes through all states,
	  and not only the unoccupied ones
	  *) When verbose output is on, the eigensolver does not output the
	  progress bar -- the output was a bit messy when running from a
	  terminal

2009-01-26 09:29  marques

	* [r4898] src/main/unocc.F90: Sorry, forgot a stop

2009-01-26 09:30  marques

	* [r4899] src/scf/lcao_inc.F90: ...and a print... I am really
	  sloppy ;))

2009-01-26 13:20  acastro

	* [r4900] src/scf/eigen.F90: The use of an optional variable was
	  causing the code to break whenever
	  that variable was not present.

2009-01-26 21:12  acastro

	* [r4901] src/basic/Makefile.am, src/basic/loct.F90,
	  src/basic/loct_inc.F90, src/states/states.F90, src/td/td_rti.F90:
	  Added a routine, loct_copy_pointer, that permits to copy the
	  arrays
	  defined as pointers in derived data types. There are quite a few
	  places in the code where this has to be done, and it is annoying
	  to do
	  the same every time (I changed a couple of places, but there are
	  some
	  more around).
	  
	  I am not sure, however, if Fortran has a smarter way to do this.

2009-01-29 20:35  dstrubbe

	* [r4902] src/main/main.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc_inc.F90: *) Compiler flags is no
	  longer truncated to 80 characters at top of output, so you can
	  see the whole string
	  *) A few corrections to comments

2009-01-30 04:10  dstrubbe

	* [r4903] src/basic/io.F90, src/grid/derivatives.F90,
	  src/grid/scalar_mesh.F90, src/include/global.h,
	  src/ions/geometry.F90, src/ions/solids.F90,
	  src/main/one_shot.F90, src/main/unocc.F90, src/scf/scf.F90,
	  src/states/states_kpoints.F90: *) Variable reference stated that
	  if no k-points blocks were provided, the default was the gamma
	  point, but this was not actually implemented and instead an error
	  message was written. Now the default has been implemented.
	  *) When there are atoms that are too close, before exiting, the
	  program writes the geometry to static/geometry.xyz so you can
	  actually see what the problem is.
	  *) All instances of "static" I could find, specifying the output
	  directory, have been replaced by a preprocessor constant
	  STATIC_DIR to make sure they are all really the same.
	  *) Some miscellaneous formatting and corrections to comments.

2009-01-30 13:18  acastro

	* [r4904] src/grid/scalar_mesh.F90, src/main/unocc.F90,
	  src/opt_control/iter.F90, src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90,
	  src/opt_control/propagation.F90, src/opt_control/target.F90: o
	  Added a '/' after the STATIC_DIR, recently introduced by David,
	  in a
	  couple of places where it was missing.
	  
	  o Some maintenance changed in the opt_control directory (removal
	  of
	  unnecessary variables, etc.)

2009-01-30 14:38  xavier

	* [r4905] src/grid/mesh_init.F90, src/grid/nl_operator.F90: To save
	  memory, now the mesh%resolution array is only allocated if
	  multiresolution is actually used.

2009-01-30 15:31  xavier

	* [r4906] src/grid/mesh.F90, src/ions/simul_box.F90,
	  src/main/unocc_inc.F90: * Whether resolution is allocated or not
	  is now considered by memory run mode.
	  * Fixed an out of bounds in the calculation of matrix elements.

2009-01-31 11:21  xavier

	* [r4907] src/basic/Makefile.am, src/basic/distributed.F90,
	  src/basic/mpi_lib.F90, src/basic/multicomm.F90,
	  src/basic/profiling.F90, src/grid/basins.F90, src/grid/batch.F90,
	  src/grid/cube_function.F90, src/grid/curv_modine.F90,
	  src/grid/curvlinear.F90, src/grid/fourier_space.F90,
	  src/grid/grid.F90, src/grid/gridhier.F90, src/grid/multigrid.F90,
	  src/grid/ob_interface.F90, src/grid/stencil.F90,
	  src/grid/stencil_cube.F90, src/grid/stencil_star.F90,
	  src/grid/stencil_starplus.F90, src/grid/stencil_variational.F90,
	  src/hamiltonian/hgh_projector.F90,
	  src/hamiltonian/kb_projector.F90, src/hamiltonian/ob_lead.F90,
	  src/hamiltonian/rkb_projector.F90, src/include/global.h,
	  src/ions/crystal.F90, src/ions/geometry.F90,
	  src/ions/simul_box.F90, src/ions/vibrations.F90,
	  src/ions/xyz_file.F90, src/main/casida.F90, src/main/gcm.F90,
	  src/main/geom_opt.F90, src/main/phonons_fd.F90,
	  src/main/static_pol.F90, src/main/unocc.F90,
	  src/math/Makefile.am, src/math/fftw3.F90, src/math/lalg_adv.F90,
	  src/math/math.F90, src/math/ode_solver.F90,
	  src/math/root_solver.F90, src/math/solvers.F90,
	  src/math/splines.F90, src/math/tdfunction.F90,
	  src/opt_control/filters.F90, src/opt_control/initst.F90,
	  src/opt_control/iter.F90, src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90, src/opt_control/propagation.F90,
	  src/opt_control/target.F90, src/poisson/conj_grad.F90,
	  src/poisson/corrections.F90, src/poisson/solver_isf.F90,
	  src/poisson/solver_multigrid.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/species/atomic.F90,
	  src/species/logrid.F90, src/species/ps.F90,
	  src/species/ps_cpi.F90, src/species/ps_cpi_file.F90,
	  src/species/ps_fhi.F90, src/species/ps_fhi_file.F90,
	  src/species/ps_hgh.F90, src/species/ps_in_grid.F90,
	  src/species/ps_psf.F90, src/species/ps_psf_file.F90,
	  src/species/ps_upf.F90, src/species/species.F90,
	  src/states/elf.F90, src/states/excited_states.F90,
	  src/states/linear_response.F90, src/states/magnetic.F90,
	  src/states/mix.F90, src/states/restart.F90, src/states/smear.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/phonons_lr.F90, src/sternheimer/sternheimer.F90,
	  src/sternheimer/vdW.F90, src/system/energy.F90,
	  src/system/exponential_split.F90, src/system/output_h_sys.F90,
	  src/system/system.F90, src/system/xc_OEP_kernel.F90,
	  src/td/ob_mem.F90, src/td/ob_rti.F90, src/td/ob_src.F90,
	  src/td/pes.F90, src/td/spectrum.F90, src/td/td_write.F90,
	  src/utils/broad.F90, src/utils/cross_section.F90,
	  src/utils/dielectric_function.F90,
	  src/utils/oscillator_strength.F90, src/utils/phonon_spectrum.F90:
	  * Included the possibility of doing a space (memory) profiling in
	  Octopus.

2009-01-31 19:51  xavier

	* [r4908] src/sternheimer/sternheimer_inc.F90: The resulting vector
	  after solving the Sternheimer equation has to be
	  re-orthogonalized, this greatly increases convergency (we had
	  this
	  before and it was removed at some point).

2009-01-31 22:58  xavier

	* [r4909] src/sternheimer/sternheimer_inc.F90,
	  src/system/linear_solver_inc.F90: Orthogonalizing the initial
	  search direction in the bigcstab
	  algorithms improves considerably the convergence rate of the
	  algorithm.

2009-02-01 11:23  xavier

	* [r4910] src/states/linear_response_inc.F90,
	  src/sternheimer/em_resp.F90, src/sternheimer/sternheimer.F90,
	  src/sternheimer/sternheimer_inc.F90,
	  src/system/linear_solver_inc.F90: * Fixed a problem with the
	  bicgstab solver introduced in my last commit.
	  * Some code cleaning in sternheimer.

2009-02-01 11:59  xavier

	* [r4911] src/system/linear_solver_inc.F90: Remove unnecessary
	  initializations to zero in the bicgstab solver.

2009-02-01 13:57  xavier

	* [r4912] src/sternheimer/sternheimer_inc.F90: Unit conversion was
	  missing in Sternheimer output.

2009-02-01 14:21  xavier

	* [r4913] src/hamiltonian/scf_tol.F90: Changed the default value of
	  the AdaptiveTolFactor variable to 0.9.
	  This seems to give the best results.

2009-02-01 21:04  xavier

	* [r4914] src/sternheimer/em_resp.F90: Another unit conversion
	  missing.

2009-02-03 10:24  xavier

	* [r4915] src/hamiltonian/epot.F90, src/hamiltonian/epot_inc.F90,
	  src/sternheimer/phonons_lr.F90, src/system/pert_inc.F90: Added
	  the possibility of precalculating the ionic potential and
	  storing it instead of calculating it every time, this is useful
	  for
	  the calculation of vibrational modes where the calculation of the
	  dynamical matrix consumes considerable time.

2009-02-03 13:44  xavier

	* [r4916] src/ions/vibrations.F90, src/sternheimer/phonons_lr.F90:
	  * The dynamical matrix is now printed by components.
	  * One expectation value does not have to be calculated.

2009-02-03 14:43  xavier

	* [r4917] src/basic/profiling.F90: Memory profiling produced huge
	  files, now only allocations that
	  actually change the memory footprint of the program are reported.

2009-02-03 16:17  xavier

	* [r4918] src/sternheimer/phonons_lr.F90: The symmetry of the
	  dynamical matrix is now take into account.

2009-02-03 20:25  acastro

	* [r4919] src/opt_control/parameters.F90: Corrected some little bug
	  in the use of mixing schemes for OCT runs.

2009-02-04 02:30  dstrubbe

	* [r4920] src/hamiltonian/epot_inc.F90, src/scf/eigen.F90,
	  src/states/states.F90: A few trivial changes.

2009-02-04 13:01  marques

	* [r4921] src/main/casida.F90, src/main/one_shot.F90,
	  src/states/states.F90, src/sternheimer/sternheimer.F90,
	  src/system/v_ks.F90, src/xc/vxc.F90: Cleaned a bit the generation
	  of the total density that goes in the
	  calculation of vxc and fxc.

2009-02-04 13:07  marques

	* [r4922] src/sternheimer/em_resp_calc_inc.F90: The evaluation of
	  kxc was not taking non-linear core corrections into account

2009-02-04 17:59  xavier

	* [r4923] src/sternheimer/phonons_lr.F90, src/system/pert.F90,
	  src/system/pert_inc.F90: The <0|2|0> term of the dynamical matrix
	  now is calculated directly
	  instead of using pert_expectation_value, the previous way was
	  very
	  slow (80% of computer time).

2009-02-05 08:14  xavier

	* [r4924] src/scf/scf.F90: The ConvRelForce criterion was not well
	  defined, its value was always
	  1.0. So I removed it and renamed ConvAbsForce to ConvForce.

2009-02-06 00:23  dstrubbe

	* [r4925] libxc/m4/acx.m4, m4/fortran.m4: The macro that checks for
	  "very long lines" used a test program with a line that was very
	  long, but still not nearly so long as some lines generated by the
	  ALLOCATE preprocessor macro in the code. The PGI 8.0-1 Fortran
	  compiler passed that test in the configure script since it could
	  handle 140 characters in a line, but could not handle 270
	  characters. I approximately tripled the length of that line in
	  the test program to 433 characters, so that now PGI is considered
	  not to accept long lines.

2009-02-06 09:59  xavier

	* [r4926] src/hamiltonian/Makefile.am,
	  src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/hamiltonian/scissor.F90,
	  src/hamiltonian/scissor_inc.F90: Now a scissor operator can be
	  included in the hamiltonian. (still not
	  tested).

2009-02-06 11:07  xavier

	* [r4927] src/hamiltonian/scissor_inc.F90: Some fixed in the
	  scissor operator.

2009-02-06 17:54  dstrubbe

	* [r4928] src/hamiltonian/epot.F90, src/scf/scf.F90,
	  src/states/smear.F90: *) The single-point Berry's phase dipole
	  calculation gives an error if the smearing is not semiconducting,
	  since otherwise it is unclear (or maybe impossible) to construct
	  a Slater determinant.
	  *) The quantum of polarization is used to reduce the dipole (in
	  the periodic case) to the smallest magnitude, for ease of
	  analysis.

2009-02-06 23:30  xavier

	* [r4929] src/basic/loct_inc.F90: Pointer copy routines now use a
	  forall loop.

2009-02-06 23:31  xavier

	* [r4930] src/beak/operate_ri.c, src/poisson/solver_multigrid.F90:
	  Gauss seidel relaxation is now done by a C routine.

2009-02-06 23:46  xavier

	* [r4931] configure.ac, src/beak/beak.h: The changes in the macros
	  made by Miguel caused that SSE was not used
	  in any compiler. Miguel, if compilation fails in Milipeia can you
	  send
	  the error so we can write a proper fix?

2009-02-07 09:59  xavier

	* [r4932] src/beak/operate_ri.c, src/grid/multigrid.F90,
	  src/grid/multigrid_inc.F90, src/poisson/solver_multigrid.F90:
	  Several improvements in the multigrid code.

2009-02-07 11:35  xavier

	* [r4933] src/hamiltonian/scissor_inc.F90, src/td/td.F90,
	  src/td/td_init.F90: Added the option of adding a scissor operator
	  to the Hamiltonian
	  during time propagation. Still testing is needed.

2009-02-07 17:42  xavier

	* [r4934] src/td/td.F90: The phase of the ground state orbitals for
	  the scissor operator was
	  missing. Now the scissor operator works properly for fixed atoms.

2009-02-08 17:16  xavier

	* [r4935] src/sternheimer/em_resp.F90: Fixed a serious memory leak
	  in sternheimer when several frequencies
	  were calculated (lr wave-functions were allocated again for each
	  frequency).

2009-02-08 18:08  xavier

	* [r4936] testsuite/linear_response/02-h2o_pol_lr.test: My last
	  commit changed a bit the results of a test.

2009-02-08 19:11  xavier

	* [r4937] src/sternheimer/sternheimer_inc.F90: As discussed with
	  David, now only one preorthogonalization (before
	  calculating the density) is done.

2009-02-09 17:57  acastro

	* [r4938] src/basic/messages.F90, src/opt_control/Makefile.am,
	  src/opt_control/check_input.F90, src/opt_control/opt_control.F90,
	  src/opt_control/opt_control_constants.F90,
	  src/opt_control/opt_control_global.F90,
	  src/opt_control/parameters.F90, src/opt_control/propagation.F90,
	  src/opt_control/read.F90: Added documentation for some variables,
	  and some comments in the
	  code. Also, some re-naming and maintenance changes in the OCT
	  part.

2009-02-09 21:45  dstrubbe

	* [r4939] src/hamiltonian/epot.F90, src/hamiltonian/epot_inc.F90,
	  src/ions/geometry.F90, src/sternheimer/em_resp.F90: *)
	  Implemented calculation of Born effective charges, from the
	  derivative of the ionic forces with respect to electric
	  perturbation. Still in testing.
	  *) Some tweaks to output in em_resp.
	  *) In em_resp, renamed "dir" variable to "idir" to reduce
	  confusion between direction and directory.

2009-02-09 22:40  acastro

	* [r4940] src/hamiltonian/epot_inc.F90,
	  src/sternheimer/em_resp.F90: A couple of problems caught by my
	  compiler: ".eq." should not be used
	  for booleans (use ".eqv." instead), some intent(in) should be
	  intent(inout), and one line too long.

2009-02-11 02:23  dstrubbe

	* [r4941] src/hamiltonian/epot_inc.F90,
	  src/sternheimer/em_resp.F90: *) A bit of cleaning up
	  *) Born charges now given as magnitude and phase rather than real
	  and imaginary part, which seems more useful

2009-02-11 20:39  dstrubbe

	* [r4942] src/hamiltonian/epot.F90: I previously made the
	  calculation in a periodic system fail if semiconducting smearing
	  was not used, because my routine to
	  calculate the dipole could not handle other smearing schemes. But
	  I shouldn't have made it impossible to do these runs;
	  it's just that the dipole is not accurate. Now just a warning is
	  written.

2009-02-11 23:57  xavier

	* [r4943] src/grid/io_function_inc.F90: Bugfix: Units were not
	  considered by dx output.

2009-02-12 05:06  dstrubbe

	* [r4944] src/hamiltonian/epot_inc.F90,
	  src/sternheimer/em_resp.F90: *) Now using minus frequency as well
	  for non-zero frequencies for Born effective charges.
	  *) The acoustic sum rule is now checked and the degree of
	  violation output, before correcting it.
	  *) I think there was a factor of st%d%kweights(ik) missing for
	  calculation of regular forces in the non-local pseudopotential
	  part

2009-02-12 05:19  dstrubbe

	* [r4945] share/util/display_mesh_index.gp,
	  src/sternheimer/em_resp.F90: *) Removed a debugging statement
	  accidentally left in my last commit,
	  which I think caused a compilation failure
	  *) Made the display gnuplot script work

2009-02-12 05:28  dstrubbe

	* [r4946] src/grid/io_function.F90, src/hamiltonian/epot_inc.F90,
	  src/ions/simul_box.F90: *) Actually I think the problem was
	  breaking a line in an ASSERT macro
	  *) Added an error message when you don't specify OutputHow
	  because previously it just did nothing if you hadn't specified
	  the output method
	  *) A little formatting

2009-02-12 09:08  acastro

	* [r4947] src/hamiltonian/epot_inc.F90: Another problem with long
	  lines (even if the ASSERT macro is broken
	  into several lines, it may happen that the argument is already
	  too
	  long).

2009-02-13 03:33  dstrubbe

	* [r4948] src/hamiltonian/epot_inc.F90,
	  src/sternheimer/em_resp.F90: A fix for Born charges at zero
	  frequency.

2009-02-13 10:52  acastro

	* [r4949] src/basic/command_line.F90, src/basic/getopt_f.c,
	  src/td/spectrum.F90, src/utils/harmonic_spectrum.F90: o Repaired
	  the calculation of the harmonic spectrum from the
	  acceleration, which was broken for low dimensional systems (the
	  file
	  was not properly read).
	  
	  o I introduced another mode for the oct-harmonic-spectrum
	  utility: for
	  each multiple of the fundamental frequency, an algorithm looks
	  for the
	  peak of the spectrum in its vicinity. The program then these
	  maxima
	  only.

2009-02-14 00:26  dstrubbe

	* [r4950] src/grid/grid.F90, src/grid/gridhier_inc.F90,
	  src/grid/multigrid.F90, src/grid/multigrid_inc.F90,
	  src/hamiltonian/epot.F90, src/hamiltonian/epot_inc.F90: A while
	  ago, gr%m was renamed to gr%mesh, so as not to have a
	  single-letter variable name. I continued this by changing m to
	  mesh in the multigrid and fine meshes, and some functional
	  arguments.

2009-02-14 14:34  acastro

	* [r4951] src/poisson/solver_multigrid.F90,
	  src/system/preconditioners_inc.F90: Some "m" that still needed to
	  be changed to "mesh".

2009-02-14 15:18  acastro

	* [r4952] src/hamiltonian/epot_inc.F90,
	  src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90,
	  src/opt_control/propagation.F90: o The use of an optional
	  argument without checking if it is really
	  present caused a segfault.
	  
	  o Removal of some unused variables.

2009-02-15 11:08  acastro

	* [r4953] src/basic/command_line.F90, src/basic/getopt_f.c,
	  src/opt_control/target.F90, src/td/spectrum.F90,
	  src/utils/harmonic_spectrum.F90: Cleaned up the harmonic spectrum
	  calculation, which I had messed up a
	  little.

2009-02-15 18:33  acastro

	* [r4954] src/opt_control/initst.F90,
	  src/opt_control/opt_control.F90, src/opt_control/parameters.F90,
	  src/opt_control/propagation.F90, src/opt_control/target.F90:
	  Improved the printing of the Fourier transform of the control
	  functions used for QOCT runs. In the way, some unimportant
	  details
	  were fixed.

2009-02-15 20:11  xavier

	* [r4955] src/grid/hypercube.F90: Included routines to convert from
	  an hypercubical grid to a linear
	  array and back. These routines were written by Nicole Helbig and
	  this
	  is a copy of her original code, they are not used yet.

2009-02-15 20:47  xavier

	* [r4956] src/grid/Makefile.am, src/grid/hypercube.F90: Moved
	  hypercube routines inside a module and changed the code to
	  octopus style.

2009-02-15 21:42  xavier

	* [r4957] src/sternheimer/em_resp.F90: Corrected the calculation of
	  circular dichroism.

2009-02-16 00:00  dstrubbe

	* [r4958] src/sternheimer/em_resp.F90: Now the tensor combinations
	  of the hyperpolarizability for hyper-Rayleigh scattering (HRS)
	  are calculated, for the VV and HV polarizations.

2009-02-16 08:22  xavier

	* [r4959] src/sternheimer/em_resp.F90: Changed the message
	  displayed for circular dichroism.

2009-02-16 09:00  xavier

	* [r4960] src/grid/Makefile.am, src/grid/hypercube.F90,
	  src/grid/index.F90, src/grid/mesh.F90, src/grid/mesh_init.F90,
	  src/ions/simul_box.F90: Defined a new boxshape: hypercube
	  (actually an hyperparallelepiped).
	  This is to introduce arbitrary dimensions in octopus.

2009-02-16 15:45  xavier

	* [r4961] src/grid/hypercube.F90, src/grid/mesh.F90,
	  src/grid/mesh_init.F90, src/grid/nl_operator.F90,
	  src/ions/simul_box.F90: Now the hypercubic grid is working (up to
	  3d).

2009-02-16 23:17  xavier

	* [r4962] src/grid/multigrid.F90, src/ions/crystal.F90,
	  src/ions/simul_box.F90, src/math/math_inc.F90,
	  src/system/pert_inc.F90: Some fixes required for running with
	  MAX_DIM = 4.

2009-02-17 17:27  acastro

	* [r4963] src/opt_control/check_input.F90: For QOCT runs, mask-type
	  absorbing boundaries were not allowed;
	  however in certain cases they should be allowed. I corrected the
	  check
	  in order to allow those cases.

2009-02-18 03:23  dstrubbe

	* [r4964] src/hamiltonian/species_pot.F90, src/ions/Makefile.am,
	  src/ions/dynamics.F90, src/ions/interaction.F90,
	  src/ions/ion_dynamics.F90, src/ions/ion_interaction.F90: *)
	  Changed the name of a misleadingly labeled routine in its
	  push_sub() command
	  *) Changed the names of two files to correspond to the names of
	  their modules

2009-02-18 15:21  nitsche

	* [r4965] src/grid/mesh.F90, src/grid/mesh_init.F90: * Fixed the
	  transport mode. Problems were:
	  - MAX_DIM<==>sb%dim related stuff
	  - optimization of the mesh in blocks does not work with the
	  transport mode. MeshBlockSizeXY and MeshBlockSizeXY must be both
	  1.
	  - a non-initialized pointer
	  There is still a problem with MPI, so I will not switch on the
	  tests yet...

2009-02-19 06:18  xavier

	* [r4966] src/hamiltonian/epot_inc.F90: Bugfix: Now the epot_force
	  uses complex values, but the MPI routines
	  where still using MPI_FLOATs. This caused the forces to be wrong
	  in
	  parallel runs.

2009-02-19 07:01  xavier

	* [r4967] src/hamiltonian/hamiltonian.F90, src/ions/crystal.F90,
	  src/ions/simul_box.F90, src/states/states_kpoints.F90: More fixes
	  for MAX_DIM = 4.

2009-02-19 07:44  xavier

	* [r4968] src/sternheimer/em_resp.F90: A repeated + sign caused
	  problems with some compilers.

2009-02-19 10:23  xavier

	* [r4969] src/states/states.F90: Bugfix: After Miguel's commit
	  [4921] the spinor tests started failing.
	  This fixes it, it seems to me that there was a previous bug for
	  systems with core corrections and spinors that Miguel's commit
	  extended to all systems with spinors.
	  
	  It would be nice it someone could review my changes.

2009-02-19 13:26  acastro

	* [r4970] src/states/states.F90: The previous commit (#4969)
	  "overcorrected" one mistake that caused a
	  failure in the spinors test since #4921. It turns out that one of
	  the
	  changes from spin_channels to nspin was right, but the other two
	  were
	  not. Now I think that the routine is correct, and the test is
	  passed.

2009-02-19 13:38  acastro

	* [r4971] src/main/casida.F90: Corrected a typo in the
	  documentation that caused some confusion in
	  the users. Thanks to Myrta Gruning for finding this out.

2009-02-19 14:29  xavier

	* [r4972] src/grid/submesh.F90, src/hamiltonian/projector.F90,
	  src/ions/solids.F90, src/main/main.F90, src/states/states.F90:
	  More fixes for MAX_DIM = 4.

2009-02-19 15:27  xavier

	* [r4973] src/ions/xyz_file.F90: Components higher than 3 of the
	  velocity are now initialized to zero.

2009-02-19 15:52  xavier

	* [r4974] configure.ac: Now the value of MAX_DIM can be changed
	  from the configure script.

2009-02-19 17:24  xavier

	* [r4975] src/grid/derivatives.F90, src/grid/derivatives_inc.F90,
	  src/ions/simul_box.F90, src/scf/scf.F90, src/states/states.F90:
	  Welcome to the fourth dimension!
	  ================================
	  
	  Now Octopus works in 4D mode, to do it you have to configure
	  octopus with
	  --with-max-dim=4 and put dimensions=4 in the input file. Only
	  non-iteracting electrons with user defined species can be used.

2009-02-19 17:48  xavier

	* [r4976] src/grid/hypercube.F90: Memory allocations made a huge
	  overhead in the hypercube routines.

2009-02-19 23:19  dstrubbe

	* [r4977] src/hamiltonian/epot.F90, src/hamiltonian/projector.F90,
	  src/td/td.F90: A recent change to projector_init_phases used a
	  variable which seems only to have been initialized in some cases
	  and not in others, causing a
	  segmentation fault. Now the dimension is explicitly passed in to
	  the function, like for projector_init and submesh_init_sphere.

2009-02-20 00:20  dstrubbe

	* [r4978] src/sternheimer/kdotp.F90: Stopped every node writing
	  about degenerate subspaces in calculation of effective masses.

2009-02-20 01:29  dstrubbe

	* [r4979] src/sternheimer/kdotp.F90,
	  src/sternheimer/kdotp_calc.F90, src/system/pert_inc.F90: *)
	  Changed parenthesis for X() function macro to standard way we
	  write it
	  *) Took ownership of the two files for the kdotp perturbation

2009-02-20 02:01  dstrubbe

	* [r4980] src/hamiltonian/epot_inc.F90: *) Some fixes to the
	  calculation of forces and Born effective charges. I think
	  electron-ion forces in periodic systems were not being
	  calculated correctly since the boundary conditions were not set
	  on the ghost/boundary points before taking gradients.
	  *) Changed MAX_DIM to NDIM in a bunch of places to avoid seg
	  faults after the new 4D changes.
	  *) However, the Born charges (and hence probably the forces) are
	  still not right in periodic systems. More coming soon.

2009-02-20 03:26  dstrubbe

	* [r4981] src/math/math_inc.F90, src/system/pert_inc.F90: *) The
	  application of perturbations involved first applying phases
	  e^ikr. In fact, this is incorrect because when pseudopotential
	  projectors
	  are used, they apply these phases themselves. The phases are no
	  longer applied in the perturbations.
	  *) The phases were giving the correct result from derivatives,
	  i.e. e^-ikr grad (e^ikr u) = grad u + ik u. But it is simpler to
	  just write this
	  out where it occurs for the grad in kdotp and curl in magnetic.
	  *) To be able to use a cross product in a forall statement, I
	  declared the cross product a pure function.

2009-02-20 03:54  dstrubbe

	* [r4982] src/hamiltonian/epot_inc.F90: Now the boundary conditions
	  are set on NP_PART for the gradients as well, before they are
	  using applying pseudopotential projectors. Previously, the forces
	  in the cubic MgO crystal were exactly zero even when one of the
	  atoms was displaced. Now there is a reasonable force on that
	  displaced atom and its neighbors.
	  
	  However, the forces still break symmetry somewhat in the
	  undisplaced case, as they should actually be exactly zero then.
	  Perhaps this is due to problems in the ion-ion forces.

2009-02-20 11:14  acastro

	* [r4983] src/td/spectrum.F90: The minimization in spectrum_hs (to
	  get the maxima of the harmonic
	  spectrum) was not robust enough, which could cause the call to
	  GSL to
	  break. Now the code continues even if it does not find a minimum.

2009-02-20 16:00  xavier

	* [r4984] m4/sse.m4, src/beak/operate_ri_vec.c: This fixes the
	  compilation problem with icc 11.

2009-02-20 20:36  dstrubbe

	* [r4985] src/grid/cube_function_inc.F90,
	  src/hamiltonian/hamiltonian_inc.F90: Added and fixed some
	  push_sub statements.

2009-02-20 22:18  dstrubbe

	* [r4986] src/grid/cube_function.F90,
	  src/grid/cube_function_inc.F90, src/grid/derivatives.F90,
	  src/poisson/poisson.F90, src/poisson/solver_3D.F90,
	  src/poisson/solver_fft.F90, src/system/v_ks.F90: *) Added and
	  fixed missing push_sub statements
	  *) Changed some MAX_DIM to 3 in cube functions; 3 is hard-coded
	  into
	  many places anyway, so it is certainly not general to more
	  dimensions
	  *) Some corrections to documentation
	  *) Translated MULTIGRILLA to MULTIGRID

2009-02-20 22:53  dstrubbe

	* [r4987] src/grid/derivatives.F90, src/grid/derivatives_inc.F90,
	  src/xc/vxc.F90: *) Added more push_sub statements
	  *) Changed m to mesh in derivatives
	  *) Replaced der%mesh%sb%dim by der%dim, since there was a more
	  direct
	  way to access this information, and since mesh%sb%dim seemed to
	  cause seg faults sometimes
	  
	  However, I have still not found the source of all the seg faults
	  on
	  corvo ...

2009-02-20 23:23  dstrubbe

	* [r4988] src/system/preconditioners.F90,
	  src/system/preconditioners_inc.F90: *) Trying to make pre-filter
	  preconditioner work for Sternheimer equation in periodic boundary
	  conditions. This does not seem to make any improvement though. It
	  still does not work.
	  *) Replaced PRE_SMOOTHING by PRE_FILTER for preconditioner to be
	  consistent with names in documentation

2009-02-20 23:32  dstrubbe

	* [r4989] src/system/pert_inc.F90: My previous commit removing the
	  application of k-point phases in perturbations was mistaken. Now
	  it is back as it was.

2009-02-21 00:00  dstrubbe

	* [r4990] src/grid/derivatives_inc.F90,
	  src/hamiltonian/epot_inc.F90: *) Now k-point phases are applied
	  in calculation of forces/Born charges too
	  *) A couple of debugging statements removed that was accidentally
	  left in a previous commit

2009-02-21 15:09  xavier

	* [r4991] src/sternheimer/em_resp.F90,
	  src/sternheimer/sternheimer.F90,
	  src/sternheimer/sternheimer_inc.F90: Added the possibility of
	  giving arbitrary perturbed wave-functions to
	  the sternheimer equation.

2009-02-22 08:40  xavier

	* [r4992] src/hamiltonian/epot_inc.F90: An error in the application
	  in the phases when calculating the forces
	  was causing out of bound accesses.

2009-02-22 20:35  dstrubbe

	* [r4993] src/grid/derivatives_inc.F90, src/hamiltonian/epot.F90,
	  src/poisson/Makefile.am, src/poisson/conj_grad.F90,
	  src/poisson/corrections.F90, src/poisson/cutoffs.F90,
	  src/poisson/poisson_cg.F90, src/poisson/poisson_corrections.F90,
	  src/poisson/poisson_cutoff.F90, src/poisson/poisson_fft.F90,
	  src/poisson/poisson_isf.F90, src/poisson/poisson_multigrid.F90,
	  src/poisson/solver_fft.F90, src/poisson/solver_isf.F90,
	  src/poisson/solver_multigrid.F90: *) Corrected comments about
	  setting boundary conditions for derivatives
	  *) Changed names of files in poisson directory to correspond with
	  the names of the modules
	  *) Also changed a couple of push_sub statements and module names
	  to make everything consistent

2009-02-22 22:17  dstrubbe

	* [r4994] src/ions/simul_box.F90: The routine to periodically
	  translate atoms into the simulation box was not taking into
	  account the BoxOffset. Now it does.

2009-02-24 15:43  xavier

	* [r4995] src/basic/loct_parser.F90, src/hamiltonian/lasers.F90,
	  src/hamiltonian/ob_lead.F90, src/hamiltonian/species_pot.F90,
	  src/ions/simul_box.F90, src/opt_control/initst.F90,
	  src/opt_control/target.F90, src/poisson/poisson_fft.F90,
	  src/species/species.F90, src/states/restart.F90: Now
	  loct_parse_expression takes a vector instead of the individual
	  components.

2009-02-24 16:01  xavier

	* [r4996] liboct_parser/parser_f.c, src/basic/loct_parser.F90: Now
	  the C routine for parsing expression also takes a vector.

2009-02-24 16:25  xavier

	* [r4997] liboct_parser/parser_f.c: Now a 4d potential can be
	  specified by using 'w' as the fourth
	  dimension.

2009-02-25 10:25  marques

	* [r4998] libxc/src/Makefile.am, libxc/src/lda_c_1d_csc.c,
	  libxc/src/libxc_master.F90, libxc/src/test.c,
	  libxc/src/work_lda_1d.c, libxc/src/xc.h, libxc/src/xc_config.h,
	  libxc/src/xc_f.c, src/xc/functionals.F90: I implemented the 1D
	  correlation LDA of Barone's group. Note that this
	  has not been tested, and that there is the exchange missing...

2009-02-25 11:46  xavier

	* [r4999] src/grid/mesh_init.F90: A stencil is now always used to
	  partition the mesh.

2009-02-25 17:14  xavier

	* [r5000] src/grid/mesh_init.F90: Generalized some parts of the
	  initialization of the mesh in parallel to an
	  arbitrary number of dimensions.

2009-02-25 17:40  xavier

	* [r5001] libxc/src/Makefile.am, libxc/src/lda_c_2d_prm.c,
	  libxc/src/lda_c_2d_prm08.c, libxc/src/libxc_master.F90,
	  libxc/src/xc.h, libxc/src/xc_f.c,
	  libxc/testsuite/xc-consistency.c, src/xc/functionals.F90: Due to
	  the 31 character limitation I had to rename the lda_c_2d_prm08
	  functional
	  to lda_c_2d_prm. Miguel, can you check that I did it correctly?

2009-02-25 22:18  xavier

	* [r5002] src/grid/Makefile.am, src/grid/mesh_init.F90: Domain
	  parallelization now works in 4D.

2009-02-26 02:12  dstrubbe

	* [r5003] src/basic/loct_parser.F90: The Portland compiler objected
	  to the way the interface was declared in loct_parser, giving the
	  error:
	  PGF90-S-0070-Incorrect sequence of statements (loct_parser.F90:
	  233)
	  I moved the "module procedure" lines to after the subroutine,
	  which is what the Intel Fortran reference says is how the syntax
	  is supposed to go. I hope this is what was meant.

2009-02-26 09:25  xavier

	* [r5004] src/grid/grid.F90, src/grid/mesh_function.F90,
	  src/grid/mesh_function_inc.F90, src/grid/mesh_init.F90,
	  src/grid/multigrid.F90, src/states/restart.F90: Some code
	  cleaning.

2009-02-26 16:42  xavier

	* [r5005] src/grid/double_grid_apply.F90, src/math/fftw3.F90: Some
	  fixes for max-dim=4.

2009-02-26 21:18  dstrubbe

	* [r5006] src/grid/mesh_function_inc.F90, src/ions/simul_box.F90,
	  src/states/states.F90, src/sternheimer/kdotp.F90: *) Turned on
	  calculation of effective masses by default, since it doesn't take
	  much time and is useful as a diagnostic
	  *) Replaced some MAX_DIM by mesh%sb%dim, which were causing a seg
	  fault
	  *) Changed "m" to "mesh" in various places
	  *) Changed another one-character name: "c" to "cube"
	  *) Added a warning to documentation on variable BoxOffset since
	  its use seems to change the results for the ground state
	  significantly.
	  *) Changed "st%wfs_type == M_REAL" to "states_are_real(st)" in
	  one place

2009-02-27 02:59  dstrubbe

	* [r5007] src/sternheimer/kdotp.F90: Now the actual default value,
	  not just the documentation, for CalculateEffectiveMasses has been
	  changed.

2009-02-28 12:13  acastro

	* [r5008] src/hamiltonian/lasers.F90, src/main/gcm.F90,
	  src/main/geom_opt.F90, src/main/one_shot.F90,
	  src/main/phonons_fd.F90, src/main/unocc.F90,
	  src/opt_control/initst.F90, src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90, src/opt_control/propagation.F90,
	  src/opt_control/target.F90, src/scf/scf.F90,
	  src/states/states.F90, src/system/system.F90, src/td/td.F90,
	  src/td/td_init.F90, src/td/td_rti.F90: o The states_calc_dim
	  subroutine accepted a states_t argument as
	  intent(in), and a density as intent(out). However, in most cases
	  it
	  was the density inside the states_t variable that was passed as
	  the
	  density to be computed. This is inconsistent, although probable
	  legal
	  since the compilers did not complain. In anycase, I think it is
	  better
	  and easier to use an optional argument, that does not need to be
	  passed if it is the density of the states_t argument the one that
	  we
	  want to calculate.
	  
	  o Simplified the optimal control code in several points. Also,
	  added
	  some comments and documentation.

2009-03-01 13:59  rozzi

	* [r5009] src/grid/mesh.F90, src/hamiltonian/hamiltonian.F90:
	  implemented absorbing boundaries for the minimum box

2009-03-01 19:53  xavier

	* [r5010] src/grid/Makefile.am, src/grid/cubic_mesh.F90,
	  src/grid/cubic_mesh_low.c: This is the initial implementation of
	  the cubic grid in C. The idea is
	  to be able to use any C FFT library and avoid all the transposing
	  done
	  by Fortran FFTW.

2009-03-02 01:27  dstrubbe

	* [r5011] src/grid/io_function_inc.F90: Renamed "m" and "c" to
	  "mesh" and "cube" in some places.

2009-03-02 02:03  xavier

	* [r5012] src/hamiltonian/gauge_field.F90: The plasmon frequency
	  now is printed the correct units.

2009-03-02 10:42  xavier

	* [r5013] m4/sse.m4: Made the SSE2 test more strict by including an
	  operation in the test
	  code. Miguel can you check whether it solves the problem with
	  pathscale?

2009-03-02 13:42  marques

	* [r5014] configure.ac, m4/sse.m4: Xavier's hack did not work, so I
	  decided to revert it and to include a
	  switch to explicitly disable sse2. In this way the user can work
	  around
	  buggy compilers (even the latest version of pathscale 3.2 has the
	  problem)

2009-03-03 00:41  dstrubbe

	* [r5015] src/grid/io_function.F90, src/grid/io_function_inc.F90,
	  src/ions/simul_box.F90, src/states/restart.F90,
	  src/system/output_h_sys.F90: *) Corrected push_sub's
	  *) Removed references to obsolete gnuplot option to OutputHow,
	  which had no effect anyway
	  *) Added XCrySDen format for 3D data
	  *) Added documentation about printing linear-response density,
	  which was not mentioned in the variable reference although it was
	  implemented

2009-03-03 05:09  dstrubbe

	* [r5016] src/grid/io_function.F90, src/grid/io_function_inc.F90,
	  src/main/casida_inc.F90, src/main/static_pol.F90,
	  src/sternheimer/em_resp.F90, src/system/output_h.F90,
	  src/system/output_h_sys.F90,
	  src/system/output_linear_response.F90,
	  src/system/output_states.F90, src/system/system.F90: *) Now
	  XCrySDen output includes the actual atomic coordinates. Passing
	  in the geometry to the output functions required changes in many
	  places. Coordinates are offset so that an atom at (0,0,0) would
	  be in the center of the cell.
	  *) A small change to the XCrysDen output grid due to this strange
	  thing about general vs periodic grids.
	  *)

2009-03-03 07:50  acastro

	* [r5017] src/main/unocc.F90, src/opt_control/finalcheck.F90,
	  src/opt_control/opt_control.F90, src/opt_control/target.F90:
	  h_sys_output_states has a new interface, but its calls were not
	  updated all over the code. Now I think the all are.

2009-03-03 08:17  acastro

	* [r5018] src/poisson/poisson_fft.F90,
	  src/poisson/poisson_finite_cyl.c: A couple of bugs resulted in
	  massive memory usage when running in 2D
	  with different spacings. Thanks to Matthieu for reporting this
	  bug.

2009-03-03 10:14  xavier

	* [r5019] src/grid/cubic_mesh.F90, src/grid/cubic_mesh_low.c: Small
	  fixes in the cubic mesh.

2009-03-03 13:24  marques

	* [r5020] src/sternheimer/em_resp_calc_inc.F90,
	  src/system/pert.F90: Corrected reference and removed duplicated
	  print

2009-03-03 15:57  acastro

	* [r5021] src/math/sparskit.F90, src/td/td_rti.F90: The code did
	  not compile with sparskit, due to a couple of
	  details. Now it does (did not check that it still works with
	  sparskit,
	  though).

2009-03-03 17:47  nitsche

	* [r5022] src/grid/mesh_init.F90, src/grid/par_vec.F90,
	  src/states/restart.F90, src/states/states.F90: * changed the way
	  to check the mesh-block-size if open boundaries scheme is used,
	  now the size must explicitly set to 1
	  * read_free_states now only reads the occupied states (this
	  should change when xc is implemented for transport)
	  * vec_global2local did not check if the array global was actually
	  associated
	  * bugfix (NP -> NP_PART)
	  * new optional parameter for states_look to look for occupied
	  states

2009-03-04 01:10  xavier

	* [r5023] src/grid/cubic_mesh.F90, src/grid/cubic_mesh_low.c: Added
	  some functions to the cubic_mesh.

2009-03-04 06:26  xavier

	* [r5024] src/utils/dielectric_function.F90: Some fixes in the
	  calculation of the dielectric function.

2009-03-04 06:31  xavier

	* [r5025] external_libs/spglib/AUTHORS,
	  external_libs/spglib/COPYING, external_libs/spglib/ChangeLog,
	  external_libs/spglib/INSTALL, external_libs/spglib/Makefile.am,
	  external_libs/spglib/Makefile.in, external_libs/spglib/NEWS,
	  external_libs/spglib/README, external_libs/spglib/aclocal.m4,
	  external_libs/spglib/bravais.c, external_libs/spglib/bravais.h,
	  external_libs/spglib/cell.c, external_libs/spglib/cell.h,
	  external_libs/spglib/compile, external_libs/spglib/config.guess,
	  external_libs/spglib/config.h.in,
	  external_libs/spglib/config.sub, external_libs/spglib/configure,
	  external_libs/spglib/configure.ac, external_libs/spglib/depcomp,
	  external_libs/spglib/install-sh, external_libs/spglib/ispglib.h,
	  external_libs/spglib/ltmain.sh, external_libs/spglib/mathfunc.c,
	  external_libs/spglib/mathfunc.h, external_libs/spglib/missing,
	  external_libs/spglib/pointgroup.c,
	  external_libs/spglib/pointgroup.h,
	  external_libs/spglib/primitive.c,
	  external_libs/spglib/primitive.h, external_libs/spglib/python,
	  external_libs/spglib/python/Makefile.am,
	  external_libs/spglib/python/Makefile.in,
	  external_libs/spglib/python/ase,
	  external_libs/spglib/python/ase/Makefile,
	  external_libs/spglib/python/ase/_spglib.c,
	  external_libs/spglib/python/ase/conf.py,
	  external_libs/spglib/python/ase/example_ase.py,
	  external_libs/spglib/python/ase/index.rst,
	  external_libs/spglib/python/ase/setup.py,
	  external_libs/spglib/python/ase/spglib.py,
	  external_libs/spglib/python/ase/src,
	  external_libs/spglib/python/example.py,
	  external_libs/spglib/python/libpyspg.c,
	  external_libs/spglib/ruby, external_libs/spglib/ruby/example1.c,
	  external_libs/spglib/ruby/example1.rb,
	  external_libs/spglib/ruby/extconf_example1.rb,
	  external_libs/spglib/spacegroup.c,
	  external_libs/spglib/spacegroup.h,
	  external_libs/spglib/spacegroup_data.c,
	  external_libs/spglib/spacegroup_data.h,
	  external_libs/spglib/spacegroup_database.c,
	  external_libs/spglib/spacegroup_database.h,
	  external_libs/spglib/spglib.c, external_libs/spglib/spglib.h,
	  external_libs/spglib/spglib_f.c, external_libs/spglib/src,
	  external_libs/spglib/src/ChangeLog,
	  external_libs/spglib/src/Makefile.am,
	  external_libs/spglib/src/Makefile.in,
	  external_libs/spglib/src/bravais.c,
	  external_libs/spglib/src/bravais.h,
	  external_libs/spglib/src/bravais_art.c,
	  external_libs/spglib/src/bravais_art.h,
	  external_libs/spglib/src/cell.c, external_libs/spglib/src/cell.h,
	  external_libs/spglib/src/debug.c,
	  external_libs/spglib/src/debug.h,
	  external_libs/spglib/src/mathfunc.c,
	  external_libs/spglib/src/mathfunc.h,
	  external_libs/spglib/src/pointgroup.c,
	  external_libs/spglib/src/pointgroup.h,
	  external_libs/spglib/src/primitive.c,
	  external_libs/spglib/src/primitive.h,
	  external_libs/spglib/src/spacegroup.c,
	  external_libs/spglib/src/spacegroup.h,
	  external_libs/spglib/src/spacegroup_data.c,
	  external_libs/spglib/src/spacegroup_data.h,
	  external_libs/spglib/src/spacegroup_database.c,
	  external_libs/spglib/src/spacegroup_database.h,
	  external_libs/spglib/src/spglib.c,
	  external_libs/spglib/src/spglib.h,
	  external_libs/spglib/src/symmetry.c,
	  external_libs/spglib/src/symmetry.h,
	  external_libs/spglib/symmetry.c, external_libs/spglib/symmetry.h,
	  external_libs/spglib/test.c: Updated spglib to version 0.5.1.

2009-03-04 07:28  xavier

	* [r5026] external_libs/spglib/Makefile.am,
	  external_libs/spglib/Makefile.in,
	  external_libs/spglib/aclocal.m4, external_libs/spglib/compile,
	  external_libs/spglib/config.guess,
	  external_libs/spglib/config.h.in,
	  external_libs/spglib/config.sub, external_libs/spglib/configure,
	  external_libs/spglib/configure.ac, external_libs/spglib/depcomp,
	  external_libs/spglib/install-sh, external_libs/spglib/ltmain.sh,
	  external_libs/spglib/missing, external_libs/spglib/python,
	  external_libs/spglib/ruby, external_libs/spglib/src/Makefile.am,
	  external_libs/spglib/src/Makefile.in: * The new version of spglib
	  is now compiled.
	  * Removed some useless parts of spglib.

2009-03-04 10:47  mjv500

	* [r5027] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/system/output_h_sys.F90:
	  added mass_scaling input var

2009-03-04 12:05  xavier

	* [r5028] configure.ac, external_libs/spglib/src/Makefile.am,
	  src/common-rules.make, src/ions/Makefile.am, src/ions/spglib_f.c,
	  src/ions/symmetries.F90: Initial implementation of an interface
	  for spglib.

2009-03-04 13:27  acastro

	* [r5029] src/ions/symmetries.F90: My compiler complained about the
	  procedures "symmetries_init" and
	  "symmetries_end" being public, and the data type "symmetries_t"
	  not
	  being public. If it is not public, it cannot be the argument of a
	  public procedure.
	  
	  The components of symmetries_t may be private, though.

2009-03-04 21:35  rozzi

	* [r5030] share/util/mf.cfg, share/util/mf.net: Added a new "TD"
	  module to the dx script. This mode allows to generate a set of
	  images from a td run. The user must choose some parameters like
	  the number of time steps between consecutive frames, the value
	  and units of the time step, etc., and then the sequencer can be
	  used to go through the files in the proper td.* directories to
	  generate the images. You can conveniently combine this module
	  with the "Script mode". Press play, go for a coffee (or a beer),
	  and when you are back all the images are ready to be joined into
	  a movie. Since only one sequencer is allowed to exist, I had to
	  remove it from the slab module, where i feel it is less
	  necessary.

2009-03-04 23:51  dstrubbe

	* [r5031] src/grid/mesh_function_inc.F90: *) Some fixes to
	  push_sub's
	  *) Removed one-line setting of defaults for optional arguments
	  which can cause a seg-fault.

2009-03-05 04:59  xavier

	* [r5032] src/ions/Makefile.am, src/ions/crystal.F90,
	  src/ions/spglib_f.c, src/ions/symmetries.F90,
	  src/states/states_kpoints.F90: * Now spglib is used to analyze
	  the symmetries of the system. This is
	  much cleaner than the previous code we had.
	  
	  * Generation of k-point is now always done following the
	  Monkhorstpack
	  scheme..

2009-03-05 07:40  xavier

	* [r5033]
	  testsuite/periodic_systems/01-free_electrons.01-ground_state.inp,
	  testsuite/periodic_systems/02-cosine_potential.01-ground_state.inp,
	  testsuite/periodic_systems/03-sodium_chain.01-ground_state.inp,
	  testsuite/periodic_systems/03-sodium_chain.02-ground_state_disp.inp,
	  testsuite/periodic_systems/04-silicon.01-gs.inp: The tests for
	  periodic systems now have the k points explicitly in the
	  input file (until the new k point generator completely
	  functional).

2009-03-05 07:47  xavier

	* [r5034] src/ions/crystal.F90: For the moment symmetry reduction
	  of the Brillouin zone only works for
	  periodicity in 3 dimensions.

2009-03-05 09:13  marques

	* [r5035] libxc/src/lda_c_hl.c, libxc/src/lda_c_pw.c,
	  libxc/src/lda_c_pz.c, libxc/src/lda_c_rpa.c,
	  libxc/src/lda_c_vwn.c, libxc/src/lda_c_wigner.c,
	  libxc/src/lda_xc_teter93.c, libxc/src/work_lda.c: Cleaned a bit
	  the LDAs.

2009-03-05 13:04  marques

	* [r5036] libxc/src/lda.c, libxc/src/lda_c_hl.c,
	  libxc/src/lda_c_pw.c, libxc/src/lda_c_pz.c,
	  libxc/src/lda_c_rpa.c, libxc/src/lda_c_vwn.c,
	  libxc/src/lda_c_wigner.c, libxc/src/lda_c_xalpha.c,
	  libxc/src/lda_xc_teter93.c, libxc/src/test.c, libxc/src/util.h,
	  libxc/src/work_lda.c, libxc/src/xc.h: *) Simplified a bit more
	  the interface to the routines.
	  *) Added support for spin-unpolarized Kxc, and added the third
	  derivatives of wigner and rpa corelation functionals.

2009-03-05 16:24  mjv500

	* [r5037] src/ions/crystal.F90: presumed 3D kpoints

2009-03-05 16:25  mjv500

	* [r5038] src/states/states_calc.F90: presumed 3D kpoints

2009-03-05 16:27  mjv500

	* [r5039] src/grid/mesh_function_inc.F90, src/states/Makefile.am,
	  src/states/density_matrix.F90, src/states/embedded_particles.F90,
	  src/states/states.F90, src/system/output_h_sys.F90,
	  src/system/output_states.F90: embedded particles and density
	  matrix modules

2009-03-05 19:30  xavier

	* [r5040] src/hamiltonian/epot_inc.F90,
	  src/hamiltonian/hamiltonian.F90: * Fixed a memory leak in the
	  calculation of the forces.
	  * Some output in hamiltonian_init is outdated.
	  * Removed the debubgging output of the mass scaling.

2009-03-05 20:44  dstrubbe

	* [r5041] src/ions/crystal.F90: A push_sub got lost in the
	  reorganization of the code.

2009-03-05 22:49  xavier

	* [r5042] src/ions/symmetries.F90: Included the option of
	  generating a k point grid with reduced symmetry.

2009-03-06 00:35  dstrubbe

	* [r5043] src/system/energy_inc.F90: Fixed up some more push_sub's.
	  Really a large fraction of them do not actually correspond to the
	  file name and function name.

2009-03-06 00:37  dstrubbe

	* [r5044] src/scf/lcao_inc.F90: More push_sub's.

2009-03-06 00:39  dstrubbe

	* [r5045] src/scf/eigen_cg_inc.F90: push_sub's

2009-03-06 00:40  dstrubbe

	* [r5046] src/states/states_calc_inc.F90: push_sub's

2009-03-06 00:41  dstrubbe

	* [r5047] src/grid/batch.F90: push_sub's

2009-03-06 00:42  dstrubbe

	* [r5048] src/grid/batch_inc.F90: More push_sub's corrected while
	  using DebugLevel = 2 for stack trace

2009-03-06 00:44  dstrubbe

	* [r5049] src/grid/mesh_init.F90: push_sub's

2009-03-06 00:46  dstrubbe

	* [r5050] src/grid/nl_operator.F90, src/grid/nl_operator_inc.F90:
	  push_sub's and comments

2009-03-06 01:37  dstrubbe

	* [r5051] src/grid/par_vec.F90, src/grid/par_vec_inc.F90:
	  push_sub's and comments

2009-03-06 03:09  dstrubbe

	* [r5052] src/ions/simul_box.F90: push_sub's

2009-03-06 03:48  xavier

	* [r5053] src/ions/symmetries.F90: I disabled for the moment the
	  output of the symmetry information.

2009-03-06 10:08  marques

	* [r5054] external_libs/spglib/src/Makefile.am: debug.h has to be
	  referenced in the Makefile, otherwise it will not be
	  added to the distribution

2009-03-06 16:10  mjv500

	* [r5055] src/grid/mesh_function.F90,
	  src/grid/mesh_function_inc.F90, src/states/density_matrix.F90:
	  generalized densmat calculation to any dimension and choice of
	  embedded particle

2009-03-06 22:11  dstrubbe

	* [r5056] src/grid/derivatives_inc.F90, src/scf/subspace_inc.F90:
	  push_sub's

2009-03-07 01:39  dstrubbe

	* [r5057] src/grid/double_grid.F90, src/grid/double_grid_apply.F90,
	  src/hamiltonian/projector.F90, src/species/species.F90:
	  push_sub's and comments

2009-03-07 15:33  acastro

	* [r5058] src/poisson/Makefile.am, src/poisson/poisson.F90,
	  src/poisson/poisson_cutoff.F90, src/poisson/poisson_cutoffs.c,
	  src/poisson/poisson_fft.F90, src/poisson/poisson_finite_cyl.c,
	  src/poisson/solver_1D.F90, src/poisson/solver_3D.F90: Added the
	  reciprocal space method to integrate Hartree's integral in
	  1D for finite systems. That is, implemented the cutoff soft
	  Coulomb
	  interaction in reciprocal space for finite ("0D-periodic")
	  systems in
	  1D. This method is now the default, instead the direct sum
	  ("direct1D"), since it is way faster.
	  
	  Also, corrected the case of 1D-periodic systems in 1D, which was
	  wrong
	  because of a wrong factor in the definition of the soft-Coulomb
	  interaction in reciprocal space.
	  
	  This means that we now have reciprocal space Hartree integral
	  integrators for all possible dimensions, and periodicities:
	  3D/3D,
	  3D/2D, 3D/1D, 3D/0D, 2D/2D, 2D/1D, 2D/0D, 1D/1D and finally,
	  1D/0D (in
	  the 1D case, we assume soft Coulomb instead of normal Coulomb
	  since
	  otherwise we get infinities everywhere).

2009-03-07 18:10  acastro

	* [r5059] src/grid/mesh_init.F90: Variable "p", which should
	  contain the number of real space
	  partitions, was being used uninitialized in routine
	  mesh_partition. This caused octopus to break with my compiler,
	  although I guess some other compilers/setups would just put a
	  zero for
	  p. This however, meant that the if clause
	  
	  if(p .lt. 8) then
	  default_method = RCB
	  else
	  default_method = GRAPH
	  end if
	  
	  
	  would always be true for "RCB", whatever it means. I think it has
	  been
	  this way since r4657. Xavier, maybe you want to check this, in
	  case it
	  is relevant.

2009-03-08 08:19  dstrubbe

	* [r5060] src/grid/double_grid.F90, src/hamiltonian/projector.F90,
	  src/species/species.F90, src/sternheimer/em_resp_calc.F90: Some
	  trivial changes.

2009-03-08 11:01  xavier

	* [r5061] src/ions/simul_box.F90, src/states/states_kpoints.F90: *
	  Bugfix: the default k point was not initialized properly.
	  
	  * Removed debugging output for simul_box_in_box.

2009-03-08 11:35  xavier

	* [r5062] src/opt_control/parameters.F90: Added (again) a
	  workaround for a bug in the IBM compiler. This time I
	  put a comment to avoid it being reverted.

2009-03-09 09:11  marques

	* [r5063] libxc/src/lda.c, libxc/src/lda_c_rpa.c,
	  libxc/src/lda_c_wigner.c, libxc/src/lda_xc_teter93.c,
	  libxc/src/test.c, libxc/src/util.h, libxc/src/work_lda.c,
	  src/xc/fxc.F90, src/xc/kxc.F90, src/xc/vxc.F90: *) Added support
	  for the calculation of kxc (the 3rd derivative of Exc)
	  in libxc. I also changed the interface to something more
	  reasonable. Now
	  we have, when spin is polarized, kxc(4) = (uuu, uud, udd, ddd)
	  
	  *) Now octopus does stop if one tries to run with fxc or kxc !=
	  LDA. Up
	  to now it was simply ignoring fxc (i.e., it was performing an RPA
	  calculation). David and Xavier, please check this one out.

2009-03-09 10:16  marques

	* [r5064] libxc/src/lda_c_pz.c,
	  testsuite/linear_response/02-h2o_pol_lr.test: Now Perdew-Zunger
	  has analitic 3rd derivatives. Due to that, the values
	  of the hyperpolarizability test changed slightly (4th digit)

2009-03-09 12:30  marques

	* [r5065] Makefile.am, liboct_parser/parser_f.c,
	  liboct_parser/string_f.h, libstring_f, libxc/DONE,
	  libxc/src/test.c, src/basic/getopt_f.c, src/basic/io_binary.c,
	  src/basic/oct_f.c, src/basic/oct_gdlib_f.c, src/basic/recipes.c,
	  src/basic/varinfo_low.c, src/basic/write_iter_low.c,
	  src/common-rules.make: I got rid of libstring_f. It was replaced
	  simply by a header file
	  (string_f.h) that is included twice in octopus (liboct_parser and
	  libxc/src). The main difference is that TO_C_STR passed to a
	  subroutien
	  instead of a function.
	  
	  I used the opportunity to fix the strcasestr definition that was
	  quite
	  broken.

2009-03-09 13:39  mjv500

	* [r5066] src/states/density_matrix.F90: generalize output file
	  names dens mat

2009-03-09 14:08  marques

	* [r5067] libxc/DONE, libxc/src/lda_c_pw.c: Now pw also has
	  analytical Kxc

2009-03-09 16:51  mjv500

	* [r5068] src/states/density_matrix.F90: added normal density
	  output (in embedded dimensions)

2009-03-09 16:52  mjv500

	* [r5069] configure.ac, liboct_parser/Makefile.am,
	  libxc/configure.ac, src/common-rules.make: had to fix
	  dependencies after removal of libstring_f - someone competent
	  check this

2009-03-09 20:47  helbig

	* [r5070] src/states/density_matrix.F90: potential calculation
	  commented out

2009-03-10 01:21  xavier

	* [r5071] testsuite/periodic_systems/05-lithium.01-gs.inp,
	  testsuite/periodic_systems/05-lithium.02-td.inp,
	  testsuite/periodic_systems/05-lithium.test,
	  testsuite/periodic_systems/Makefile.am: Added test for the time
	  propagation with gauge field in solids.

2009-03-10 01:29  acastro

	* [r5072] src/hamiltonian/epot_inc.F90,
	  src/hamiltonian/projector.F90, src/hamiltonian/projector_inc.F90:
	  Bug fixed: some uninitialized variables (only when running in
	  parallel).

2009-03-10 04:30  xavier

	* [r5073] src/hamiltonian/gauge_field.F90,
	  src/hamiltonian/hamiltonian_inc.F90: Moved the application of the
	  gauge field to its own module.

2009-03-10 06:04  xavier

	* [r5074] src/td/td.F90,
	  testsuite/periodic_systems/05-lithium.02-td.inp,
	  testsuite/periodic_systems/05-lithium.03-td-restart.inp,
	  testsuite/periodic_systems/05-lithium.test,
	  testsuite/periodic_systems/Makefile.am: * Restart functionality
	  for simulations with gauge field was not working.
	  * The restart of the simulation is now checked by the test.

2009-03-10 09:04  xavier

	* [r5075] src/hamiltonian/gauge_field.F90, src/td/td.F90,
	  src/td/td_rti.F90: Now gauge_field_get_force returns an object of
	  type gauge_force_t.

2009-03-10 10:53  mjv500

	* [r5076] src/states/Makefile.am, src/states/density_matrix.F90,
	  src/states/embedded_particles.F90,
	  src/states/modelmb_particles.F90, src/system/output_states.F90:
	  changed naming of embedded to modelmb

2009-03-11 08:58  marques

	* [r5077] libxc/src/Makefile.am, libxc/src/lda_c_vwn.c,
	  libxc/src/xc_f.c: Now also VWN has analytical Kxc

2009-03-11 09:00  marques

	* [r5078] libxc/src/string_f.h: It is easier to maintain a copy of
	  this file here, so that this library
	  is indeed independent.

2009-03-12 00:06  helbig

	* [r5079] src/grid/mesh_function_inc.F90,
	  src/states/density_matrix.F90, src/states/ksinversion.F90,
	  src/states/modelmb_particles.F90: density matrix normalized,
	  kspotential inversion added(not working yet)

2009-03-12 00:37  mjv500

	* [r5080] src/states/Makefile.am, src/states/ksinversion.F90:
	  cleaned ksinversion

2009-03-14 14:58  helbig

	* [r5081] src/grid/mesh_function_inc.F90,
	  src/states/density_matrix.F90, src/states/ksinversion.F90:
	  calculation of density for ModelMB, cleaned density matrix,
	  continued with KS potential calculation

2009-03-14 15:47  mjv500

	* [r5082] src/states/density_matrix.F90: modif output names for
	  density matrices

2009-03-15 12:00  xavier

	* [r5083] src/main/geom_opt.F90, src/main/phonons_fd.F90,
	  src/main/static_pol.F90, src/scf/ground_state.F90,
	  src/scf/scf.F90, src/td/td_init.F90: Changed the order of the
	  arguments of scf_init.

2009-03-15 23:12  xavier

	* [r5084] src/main/run.F90, src/opt_control/opt_control.F90,
	  src/opt_control/propagation.F90, src/opt_control/target.F90,
	  src/td/td.F90, src/td/td_init.F90: Some consistency fixes:
	  
	  * Renamed timedep_m to td_m.
	  * Changed the order of the parameters for td_init.

2009-03-16 08:33  marques

	* [r5085] libxc/src/gga_x_am05.c, libxc/src/gga_x_b86.c,
	  libxc/src/gga_x_b86_mgc.c, libxc/src/gga_x_b88.c,
	  libxc/src/gga_x_bayesian.c, libxc/src/gga_x_dk87.c,
	  libxc/src/gga_x_ft97.c, libxc/src/gga_x_g96.c,
	  libxc/src/gga_x_lg93.c, libxc/src/gga_x_mpbe.c,
	  libxc/src/gga_x_optx.c, libxc/src/gga_x_pbe.c,
	  libxc/src/gga_x_pbea.c, libxc/src/gga_x_pw86.c,
	  libxc/src/gga_x_pw91.c, libxc/src/gga_x_rpbe.c,
	  libxc/src/gga_x_wc.c, libxc/src/lda_x.c, libxc/src/mgga_x_m06l.c,
	  libxc/src/test.c, libxc/src/util.h, libxc/src/work_gga_x.c: Som
	  cleaning in the ggas

2009-03-17 10:03  mjv500

	* [r5086] libxc/src/lda_x.c: MIGUEL CHECK THIS stray float

2009-03-17 16:28  mjv500

	* [r5087] src/states/density_matrix.F90,
	  src/states/modelmb_particles.F90: added dipole moment calculation

2009-03-19 05:35  xavier

	* [r5088] src/grid/derivatives_inc.F90, src/hamiltonian/epot.F90,
	  src/hamiltonian/epot_inc.F90, src/hamiltonian/gauge_field.F90,
	  src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/lasers_inc.F90, src/include/global.h,
	  src/main/geom_opt.F90, src/main/phonons_fd.F90,
	  src/main/static_pol.F90, src/poisson/poisson.F90,
	  src/scf/scf.F90, src/states/elf.F90, src/states/magnetic.F90,
	  src/states/modelmb_particles.F90, src/states/states.F90,
	  src/states/states_calc_inc.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/sternheimer/kdotp.F90,
	  src/sternheimer/phonons_lr.F90, src/sternheimer/vdW.F90,
	  src/system/exponential_split.F90, src/system/output_h_sys.F90,
	  src/system/output_linear_response.F90,
	  src/system/output_states.F90, src/system/pert.F90,
	  src/system/pert_inc.F90, src/system/preconditioners.F90,
	  src/system/system.F90, src/system/v_ks.F90, src/td/td.F90,
	  src/td/td_calc.F90, src/td/td_write.F90, src/xc/axc.F90,
	  src/xc/vxc.F90: Removed the NDIM macro.

2009-03-19 05:54  xavier

	* [r5089] src/hamiltonian/gauge_field.F90,
	  src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/lasers_inc.F90, src/include/global.h,
	  src/main/gcm.F90, src/main/unocc_inc.F90,
	  src/opt_control/initst.F90, src/opt_control/propagation.F90,
	  src/opt_control/target.F90, src/scf/eigen_cg_inc.F90,
	  src/scf/eigen_evolution_inc.F90, src/scf/eigen_lobpcg_inc.F90,
	  src/scf/eigen_plan_inc.F90, src/scf/eigen_rmmdiis_inc.F90,
	  src/scf/lcao_inc.F90, src/scf/ob_lippmann_schwinger.F90,
	  src/scf/subspace_inc.F90, src/states/elf.F90,
	  src/states/magnetic.F90, src/states/states.F90,
	  src/states/states_block.F90, src/states/states_calc_inc.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/system/energy_inc.F90,
	  src/system/exponential.F90, src/system/exponential_split.F90,
	  src/system/linear_solver_inc.F90, src/system/output_h_sys.F90,
	  src/system/output_linear_response.F90,
	  src/system/output_states.F90, src/system/pert_inc.F90,
	  src/system/preconditioners_inc.F90, src/td/td_rti.F90,
	  src/xc/axc.F90, src/xc/vxc.F90: Removed the NP_PART macro.

2009-03-20 09:48  marques

	* [r5090] configure.ac, liboct_parser/Makefile.am,
	  libxc/configure.ac, libxc/src/Makefile.am,
	  libxc/src/lda_c_1d_csc.c, libxc/src/lda_c_2d_amgb.c,
	  libxc/src/lda_x.c, libxc/src/test.c, libxc/src/work_lda.c,
	  libxc/src/work_lda_1d.c, src/common-rules.make,
	  src/xc/functionals.F90, src/xc/xc.F90,
	  testsuite/finite_systems_2d/01-quadratic_box.03-hartree+xc.inp,
	  testsuite/finite_systems_2d/01-quadratic_box.04-spin_polarized.inp:
	  Reorganization of the LDAs of reduced dimension. Now there is a
	  common
	  driver routine in work_lda that handles 1, 2, and 3 dimensions. I
	  also
	  took the opportunity to add fxc and kxc to the 2d ldas (both
	  exchange
	  and amgb). I do not know if his is useful (someone interested in
	  hyperpolarizabilities of 2D systems?), but I added it for
	  completeness.

2009-03-20 12:00  marques

	* [r5091] libxc/DONE, libxc/src/lda_c_2d_prm.c,
	  libxc/src/lda_c_hl.c, libxc/src/test.c: Some more fixes, and now
	  HL also has Kxc.

2009-03-20 14:40  marques

	* [r5092] libxc/src/lda_x_2d.c: Forgot this file... sorry.

2009-03-20 15:31  marques

	* [r5093] src/grid/derivatives.F90: After many requests by Matthieu
	  and Nicole, I included the possibility
	  of having different masses in the different spatial directions.
	  This is
	  controlled by the block MoldelMBMasses. I am not 100% sure that
	  this
	  works, but I think so (the harmonic oscillator works ;). The idea
	  is to
	  do a coordinate transformation when one calculates the
	  coefficients of
	  the derivatives. Note that this is a hack, and that *all*
	  derivatives in
	  the code will be afected, so be careful.
	  
	  Note that I created a new section for the variables related to
	  the
	  Many-body models (Hamiltonian::Models). Matthieu and Nicole,
	  could you
	  please move the variables you have introduced there?

2009-03-20 15:41  marques

	* [r5094] src/grid/derivatives.F90: Sorry, I had forgotten to
	  change the name of the variable ;)

2009-03-21 18:28  acastro

	* [r5095] src/grid/derivatives.F90: Changed the name of
	  "MoldelMBMasses" to "ModelMBMasses", which I
	  assume was the first idea; and added the "%End% at the end of the
	  documentation block (otherwise the perl scripts complains).

2009-03-22 14:21  acastro

	* [r5096] src/hamiltonian/lasers.F90,
	  src/opt_control/check_input.F90, src/opt_control/opt_control.F90,
	  src/opt_control/opt_control_global.F90,
	  src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90,
	  testsuite/optimal_control/04-box.06-oct_long.inp,
	  testsuite/optimal_control/04-box.07-oct_long.inp: Corrected
	  outdated documentation, added some more, added comments to
	  make the code more readable. Also, reorganised a couple of things
	  in
	  order to make things more intuitive for the user/developer (all
	  this
	  refers exclusively to OCT stuff).

2009-03-23 07:38  marques

	* [r5097] src/grid/derivatives.F90: Forgot the block_end call. I am
	  really rusty ;))

2009-03-24 15:04  nitsche

	* [r5098] src/grid/io_function_inc.F90: * updated
	  X(output_function) to handle also non-domain parallelization
	  
	  Comment: "ParallelizationStrategy = par_kpoints" is NOT working
	  (e.g. try 01-free_electrons.01-ground_state.inp), with the
	  following commits I am trying to fix some of these issues. I
	  would be glad if someone could check my changings as I am not an
	  expert in MPI...

2009-03-24 15:26  nitsche

	* [r5099] src/grid/mesh_init.F90, src/states/restart.F90: *
	  mesh_init.F90: uninitialized pointers for parallelization,
	  splitted an if statement due to an uninitialized array
	  * restart.F90: uninitialized pointer, splitted if statement if
	  read error occurs, fixed problem in read_free_states with
	  parallelization in kpoints

2009-03-24 15:58  nitsche

	* [r5100] src/system/output_states.F90: * fixed some outputs
	  related to non-domain parallelization

2009-03-24 16:56  nitsche

	* [r5101] src/td/ob_rti.F90, src/td/td_write.F90: * fixed bugs
	  related to kpoints-parallelization

2009-03-24 20:41  acastro

	* [r5102] src/hamiltonian/epot.F90: Bug fix: when using
	  pseudopotential with core charge corrections, this
	  core-charge was "accumulated" every time the ionic potential was
	  computed. This was not a problem for single-point calculations,
	  since
	  this potential was computed only once. However, it was a problem
	  for
	  example for geometry-optimization runs (in fact, I found the bug
	  because it was reported as a problem with geometry optimization
	  in the
	  mailing list).
	  
	  Version 3.0.1 is also affected by this bug (I will correct it
	  also in
	  3.0.x branch, since it is somehow a "severe" bug), and I guess
	  that
	  also td runs were compromised, if the ions moved.

2009-03-24 20:50  acastro

	* [r5103] src/hamiltonian/epot.F90: Sorry, my previous bug-fix was
	  buggy.

2009-03-25 10:00  nitsche

	* [r5105] src/hamiltonian/epot.F90, src/td/td.F90: * fixes related
	  to kpoint-parallelization

2009-03-25 10:07  nitsche

	* [r5106] src/hamiltonian/hamiltonian_inc.F90,
	  src/scf/ob_lippmann_schwinger.F90: * fixes related to
	  kpoint-parallelization

2009-03-25 10:35  nitsche

	* [r5107] src/hamiltonian/hamiltonian.F90, src/states/states.F90: *
	  again fixes issues due to kpoints-parallelization

2009-03-25 11:00  nitsche

	* [r5108] src/hamiltonian/gauge_field.F90,
	  src/states/excited_states_inc.F90: * removed useless loop
	  * fixes due to kpoints parallelization

2009-03-25 11:16  nitsche

	* [r5109] src/states/states_calc.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/system/pert_inc.F90: *
	  fixed issues related to kpoint parallelization

2009-03-25 11:22  nitsche

	* [r5110] src/system/output_linear_response.F90,
	  src/td/pes_mask.F90, src/td/pes_rc.F90: * fixed kpoint
	  parallelization related stuff

2009-03-25 12:42  nitsche

	* [r5111] src/td/td_calc.F90: * fixed issue due to kpoint
	  parallelization

2009-03-25 14:26  nitsche

	* [r5112] src/hamiltonian/lasers.F90, src/td/td_init.F90: * fixed
	  problem in laser_write_info, dt and max_iter were always zero for
	  non optimal control.
	  
	  Alberto, could you check if it is still as you intended it to be?

2009-03-26 02:06  dstrubbe

	* [r5113] src/main/run.F90, src/states/states.F90,
	  src/system/v_ks.F90: *) Some tweaks to documentation and comments
	  *) Now real wavefunctions are used for a periodic system if the
	  k-sampling is gamma-point only

2009-03-26 05:11  xavier

	* [r5114] src/hamiltonian/epot.F90,
	  src/hamiltonian/gauge_field.F90, src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/lasers_inc.F90, src/include/global.h,
	  src/main/gcm.F90, src/main/one_shot.F90, src/main/static_pol.F90,
	  src/main/unocc_inc.F90, src/opt_control/target.F90,
	  src/poisson/poisson.F90, src/poisson/poisson_multigrid.F90,
	  src/scf/eigen_cg_inc.F90, src/scf/eigen_mg_inc.F90,
	  src/scf/eigen_plan_inc.F90, src/scf/eigen_rmmdiis_inc.F90,
	  src/scf/ground_state.F90, src/scf/lcao_inc.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/scf/scf.F90,
	  src/scf/subspace_inc.F90, src/states/elf.F90,
	  src/states/magnetic.F90, src/states/restart.F90,
	  src/states/states.F90, src/states/states_calc_inc.F90,
	  src/sternheimer/em_resp_calc_inc.F90, src/system/energy_inc.F90,
	  src/system/exponential.F90, src/system/exponential_split.F90,
	  src/system/linear_solver_inc.F90, src/system/output_h_sys.F90,
	  src/system/output_linear_response.F90,
	  src/system/output_states.F90, src/system/pert_inc.F90,
	  src/system/preconditioners.F90,
	  src/system/preconditioners_inc.F90, src/system/v_ks.F90,
	  src/system/xc_OEP.F90, src/system/xc_OEP_SIC_inc.F90,
	  src/system/xc_OEP_inc.F90, src/system/xc_OEP_x_inc.F90,
	  src/td/ob_rti.F90, src/td/td.F90, src/td/td_calc.F90,
	  src/td/td_rti.F90, src/td/td_write.F90, src/xc/axc.F90,
	  src/xc/vxc.F90: Removed the NP macro.

2009-03-26 09:11  xavier

	* [r5115] src/scf/eigen_lobpcg_inc.F90: Small cleaning of lobpcg.

2009-03-26 10:27  marques

	* [r5116] libxc/ChangeLog, libxc/Makefile.am, libxc/PACKAGING,
	  libxc/configure.ac, libxc/m4/acx.m4: Several details necessary to
	  package libxc.
	  *) There is now a PACKAGING file
	  *) FCCPP explanation now appears in ./configure --help
	  *) Automatic generation of ChangeLog file -- maybe it would be
	  better to
	  separate it per years, but I don't know how to do it well...

2009-03-26 14:45  nitsche

	* [r5118] src/scf/eigen.F90, src/states/restart.F90: *
	  eigensolver_run now works with k-point parallelization
	  * fixed issues within restart_write and restart_read (k-point
	  parallelization)

2009-03-26 16:39  nitsche

	* [r5119] src/basic/io.F90, src/basic/profiling.F90: * added some
	  missing pop_sub, cleanup

2009-03-26 16:42  nitsche

	* [r5120] src/grid/derivatives_inc.F90, src/grid/mesh_init.F90,
	  src/grid/par_vec_inc.F90, src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/projector.F90, src/hamiltonian/projector_inc.F90,
	  src/main/casida.F90, src/opt_control/opt_control.F90,
	  src/poisson/poisson.F90, src/scf/eigen_lobpcg_inc.F90,
	  src/scf/lcao.F90, src/species/ps.F90, src/species/ps_hgh.F90,
	  src/states/mix_inc.F90, src/td/cpmd.F90, src/td/ob_mem.F90,
	  src/td/td.F90, src/td/td_write.F90: * added more missing pop_sub,
	  cleanup

2009-03-26 21:04  xavier

	* [r5121] src/scf/eigen_lobpcg_inc.F90: The LOBPCG solver was
	  broken for StateBlockSize smaller than the total
	  number of vectors, this fixes the problem.

2009-03-26 21:28  xavier

	* [r5122] src/states/states_block_inc.F90: Added profiling regions
	  to state_compactify and states_uncompactify.

2009-03-27 03:08  xavier

	* [r5123] src/grid/mesh_function_inc.F90,
	  src/states/states_block.F90, src/states/states_block_inc.F90: The
	  states_blockt_mul routine now uses mf_dotp_batch instead of blas
	  for the multiplication (this is faster since the copies are
	  avoided).

2009-03-27 05:26  xavier

	* [r5124] src/scf/eigen_lobpcg_inc.F90, src/scf/subspace_inc.F90,
	  src/states/states_calc_inc.F90: * Improved the interface for
	  states_linear_combination.
	  * Replaced a blas abuse by a forall loop.

2009-03-27 10:31  xavier

	* [r5125] src/scf/eigen_lobpcg.F90, src/scf/eigen_lobpcg_inc.F90: *
	  Added a progress bar to the lobpcg eigensolver.

2009-03-27 11:12  nitsche

	* [r5126] src/basic/distributed.F90, src/ions/simul_box.F90,
	  src/math/tdfunction.F90, src/states/states.F90: * fixed some
	  missing pop_sub()
	  * ierr was not initialized in td_function which was the case when
	  function_name is not found inside a block
	  * distributed_nullify was not setting the default values in
	  mpi_grp, which triggered a bug when using different
	  parallelization strategies in successive runs

2009-03-27 12:55  nitsche

	* [r5127] src/states/restart.F90: * fixed problems of loading
	  restart information for open boundaries when in parallel mode

2009-03-27 22:18  dstrubbe

	* [r5128] testsuite/linear_response/02-h2o_pol_lr.test: Changed
	  slightly the results of the hyperpolarizability test to reflect
	  the new values from Miguel's new analytic version of the LDA Kxc
	  kernel.

2009-03-30 18:05  acastro

	* [r5129] src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90: Removed some duplicated
	  variables, which were causing some
	  trouble. Also, removed the option of phase-and-envelope
	  optimization,
	  which was not coded properly. Eventually it should be put back.

2009-03-31 09:09  marques

	* [r5131] libxc/AUTHORS, libxc/NEWS, libxc/README,
	  libxc/src/lda_x.c: Little corrections to some stupid files

2009-03-31 09:29  marques

	* [r5133] libxc/ChangeLog, libxc/Makefile.am,
	  libxc/src/Makefile.am: A couple more fixes to the make
	  environment

2009-03-31 12:56  marques

	* [r5134] doc/html/vars/Makefile.am, src/basic/loct.F90,
	  src/basic/loct_inc.F90, src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/lasers_inc.F90, src/scf/eigen.F90,
	  src/scf/eigen_cg_inc.F90, src/states/Makefile.am,
	  src/states/states.F90, src/system/preconditioners.F90,
	  src/td/td_write.F90: *) Fixed all errors reported by valgrind for
	  the morse test. This included a couple of
	  uninitialized variables and some memory leaks in states_copy
	  *) Fixed dependencies to be able to do make -j4

2009-03-31 13:18  marques

	* [r5135] src/basic/loct.F90, src/basic/loct_inc.F90,
	  src/hamiltonian/hamiltonian.F90, src/hamiltonian/lasers_inc.F90,
	  src/states/states.F90, src/td/td_write.F90: *) got rid of my
	  recently introduced loct_pointer_nullify, as the macro DEALLOC
	  does the same
	  *) fixed memory leak in hartree_fock calculations

2009-03-31 13:33  marques

	* [r5136] src/td/td.F90, src/td/td_write.F90: Removed record_length
	  from writing of gauge field. It works fine with my gfortran.
	  Xavier, please
	  check if it breaks something...

2009-04-01 09:06  acastro

	* [r5137] src/opt_control/opt_control.F90,
	  src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90: Changed a little how the
	  parametrization of the control functions is
	  done. Also, added more comments and documentation.

2009-04-01 10:18  nitsche

	* [r5138] src/hamiltonian/hamiltonian.F90,
	  src/states/states_calc_inc.F90, src/system/output_h_sys.F90,
	  src/system/output_states.F90, src/td/ob_rti.F90,
	  src/td/ob_src.F90, src/td/td.F90: * fixed problem in
	  states_calc_inc.F90 when compiling with MPI
	  * numerous fixes in order to get transport working in parallel
	  
	  The propagation itself now works in parallel. The calculation of
	  the green functions is still only done by the root node.

2009-04-01 13:40  xavier

	* [r5139] src/grid/Makefile.am, src/grid/cubic_mesh.F90,
	  src/grid/cubic_mesh.h, src/grid/cubic_mesh_fft.c,
	  src/grid/cubic_mesh_low.c: Added a file for fourier space
	  routines of cubic_mesh.

2009-04-01 23:55  acastro

	* [r5140] src/td/ob_rti.F90: Just one little problem with the 132
	  column length limit in some
	  compilers (gfortran, in my case).

2009-04-02 12:30  nitsche

	* [r5141] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/ob_lead.F90, src/scf/ground_state.F90,
	  src/scf/ob_lippmann_schwinger.F90, src/states/Makefile.am,
	  src/states/ob_green.F90, src/states/states.F90: * the green
	  function calculation (for Lippmann-Schwinger) is now parallel

2009-04-02 12:44  nitsche

	* [r5142] src/states/states.F90: * bugfix for the last commit of me

2009-04-02 14:41  xavier

	* [r5143] src/grid/Makefile.am, src/sternheimer/em_resp.F90,
	  src/sternheimer/sternheimer_inc.F90: * When the system is
	  periodic, the r perturbation in Sternheimer is
	  now calculated as i d/dk. This makes the polarizability position
	  independent.
	  
	  * A build dependency was missing.

2009-04-03 05:03  xavier

	* [r5144] src/td/td_rti.F90: Parallelization in K points of the
	  time propagation.

2009-04-03 08:10  acastro

	* [r5145] src/opt_control/parameters.F90,
	  testsuite/optimal_control/04-box.test: Fix of a (small) bug in
	  the OCT part: when optimizing with fixed
	  fluence, the code was not using the fluence of the laser field
	  specified in the input file, but rather doing some
	  transformations on
	  this, and then computing the fluence. I had to change one test
	  value.

2009-04-03 09:33  xavier

	* [r5146] src/basic/profiling.F90: Memory profiling is now enable
	  separately of time profiling.

2009-04-03 12:34  xavier

	* [r5147] src/hamiltonian/hamiltonian_inc.F90: Phases for the k
	  points are now applied by blocks.

2009-04-03 12:39  xavier

	* [r5148] src/hamiltonian/hamiltonian_inc.F90: Some lines in my
	  last commit were too long.

2009-04-03 14:30  xavier

	* [r5149] src/sternheimer/kdotp.F90: Bugfix: out of bounds access
	  in kdotp.

2009-04-04 18:12  acastro

	* [r5150] src/opt_control/iter.F90, src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90: Solved some memory leaks
	  detected by valgrind.

2009-04-04 18:54  dstrubbe

	* [r5151] src/sternheimer/em_resp.F90: Missing variable
	  initialization added. Thanks to Tobias for catching this.

2009-04-05 15:23  xavier

	* [r5152] src/hamiltonian/epot.F90: The calculation of the dipole
	  for periodic systems didn't work for
	  real wave-functions. David, can you check my changes?

2009-04-05 16:31  xavier

	* [r5153] src/basic/io.F90, src/math/filters.F90,
	  testsuite/real_time/01-etrs.01-gs.inp,
	  testsuite/real_time/01-etrs.02-td.inp,
	  testsuite/real_time/01-etrs.03-td_lanczos.inp,
	  testsuite/real_time/01-etrs.test,
	  testsuite/real_time/02-aetrs.01-gs.inp,
	  testsuite/real_time/02-aetrs.02-td.inp,
	  testsuite/real_time/02-aetrs.03-td_lanczos.inp,
	  testsuite/real_time/02-aetrs.test,
	  testsuite/real_time/03-exp_mid.01-gs.inp,
	  testsuite/real_time/03-exp_mid.02-td.inp,
	  testsuite/real_time/03-exp_mid.test,
	  testsuite/real_time/05-cpmd.01-gs.inp,
	  testsuite/real_time/05-cpmd.02-verlet.inp,
	  testsuite/real_time/05-cpmd.03-vel_verlet.inp,
	  testsuite/real_time/05-cpmd.test,
	  testsuite/real_time/07-visscher.01-gs.inp,
	  testsuite/real_time/07-visscher.02-td.inp,
	  testsuite/real_time/07-visscher.test: Enabled pseudopotential
	  filtering in several tests.

2009-04-05 16:35  xavier

	* [r5154] src/basic/io.F90, src/math/filters.F90: Commited this
	  changes by mistake.

2009-04-05 18:42  dstrubbe

	* [r5155] src/hamiltonian/epot.F90: Thanks Xavier for noticing the
	  problem with the single-point Berry's phase calculation when we
	  have real wavefunctions. Your fix made only diagonal elements be
	  calculated though; now it is corrected.

2009-04-05 22:05  acastro

	* [r5156] src/math/splines.F90, src/math/tdfunction.F90,
	  src/opt_control/check_input.F90, src/opt_control/parameters.F90,
	  src/opt_control/parameters_trans.F90,
	  testsuite/optimal_control/04-box.06-oct_long.inp,
	  testsuite/optimal_control/04-box.07-oct_long.inp: Added the
	  option of representing a control function (for the OCT part)
	  as a Fourier series, but without the constrain of keeping a fixed
	  fluence (up to now one could represent it as a Fourier series,
	  but
	  always doing a fixed-fluence search).

2009-04-05 22:28  acastro

	* [r5157] src/hamiltonian/epot.F90: There was one extra parenthesis
	  that prevented the compilation.

2009-04-06 07:10  xavier

	* [r5158] src/species/ps.F90: HGH pseudopotentials set the l of the
	  local component to -1, this
	  caused the filtering to fail. So I changed l_loc to 0, But I am
	  not
	  sure if this correct or not.

2009-04-06 13:16  xavier

	* [r5159] src/species/ps.F90: My previous commit was wrong. Wow
	  l_loc = 0 is only used in HGH for
	  the filtering of the local part.

2009-04-06 15:49  xavier

	* [r5160] src/scf/eigen_rmmdiis_inc.F90: I started to reimplement
	  the diis solver based on the vasp paper.

2009-04-06 16:32  nitsche

	* [r5161] src/grid/ob_interface.F90,
	  src/hamiltonian/gauge_field.F90, src/hamiltonian/hamiltonian.F90,
	  src/states/restart.F90, src/states/states.F90,
	  src/system/output_states.F90, src/td/ob_rti.F90,
	  src/td/ob_src.F90: * corrected the (huge) overhead for open
	  boundaries due to the gs periodic run, now the speed of the
	  previous version is reached
	  * bug in h_sys_output_current_flow (k-points and states
	  parallelization)
	  * info for lead potentials can now show longer formulas
	  * corrected push_sub call (wrong name)

2009-04-06 16:47  xavier

	* [r5162] src/scf/eigen.F90, src/scf/eigen_rmmdiis_inc.F90: * The
	  DIIS iteration now ends with a trial move.
	  * The default number of iterations is now 3 (the recommended
	  value).

2009-04-07 09:56  xavier

	* [r5163] src/hamiltonian/species_pot.F90, src/math/filters.F90,
	  src/species/ps.F90: Now atomic orbitals are also passed by
	  filter, this improves a bit the
	  quality of the LCAO.

2009-04-08 10:02  xavier

	* [r5164] src/opt_control/parameters.F90: OCT runs fail with g95,
	  it seems that this is caused by a compiler
	  bug. Now octopus stops with an error in this case.

2009-04-08 12:14  xavier

	* [r5165] src/hamiltonian/species_pot.F90, src/math/filters.F90,
	  src/species/ps.F90: I remove the filtering of atomic orbitals, I
	  will put it back after
	  releasing.

2009-04-08 12:36  xavier

	* [r5166] src/ions/vibrations.F90,
	  testsuite/linear_response/04-vib_modes.test: The output of the
	  vibrational modes test did not have a fixed format,
	  this caused the test to fail for some compilers.

2009-04-08 13:12  xavier

	* [r5167] testsuite/linear_response/03-vdw_sternheimer.test:
	  Updated the value for the VdW tests, now it is passed by the four
	  compilers I tried. The difference was quite small (0.0002).

2009-04-08 13:16  marques

	* [r5168] src/basic/loct_inc.F90, src/grid/derivatives.F90,
	  src/grid/nl_operator.F90, src/grid/stencil.F90: Fixed the long
	  standing memory leak when running with curvilinear coordinates.
	  Please be very careful next time you use _copy routines!!!!
	  
	  -This line, and those below, will be ignored--
	  
	  M src/basic/loct_inc.F90
	  M src/grid/derivatives.F90
	  M src/grid/stencil.F90
	  M src/grid/nl_operator.F90

2009-04-08 14:30  marques

	* [r5169] src/main/casida.F90: I belive that I fixed a couple of
	  memory leaks in casida. I am not sure, that I caught them all and
	  that I did not introduce further bugs. Let's wait for buildbot...

2009-04-08 14:53  marques

	* [r5170] src/states/linear_response.F90, src/sternheimer/vdW.F90:
	  Now the memory leaks in vdW were corrected. There is a bit of a
	  problem with the DEALLOC macro that only works for pointers. I
	  think we should have a macro for pointers and another for
	  allocatable arrays. I will think about it after the release...

2009-04-08 14:59  mjv500

	* [r5171] src/ions/crystal.F90: output format bugs for MAXDIM not 3

2009-04-08 15:01  mjv500

	* [r5172] src/grid/io_function.F90, src/grid/io_function_inc.F90,
	  src/states/density_matrix.F90: 4D output improvements

2009-04-08 15:15  marques

	* [r5173] src/basic/oct_f.c, src/grid/index.F90,
	  src/grid/mesh_function_inc.F90, src/ions/crystal.F90,
	  src/ions/simul_box.F90, src/math/root_solver.F90: Some compiler
	  warnings fixed

2009-04-09 18:19  xavier

	* [r5174] src/scf/lcao.F90, src/scf/lcao_inc.F90: Parallelization
	  in k points of LCAO: the eigenvalues are now
	  allgathered.

2009-04-09 18:32  xavier

	* [r5175] src/states/ksinversion.F90: Removed a ' from comments.

2009-04-09 18:37  micael

	* [r5176] liboct_parser/Makefile.am: string_f.h was not included in
	  the distribution, although I'm not sure this is the correct way
	  of fixing it.

2009-04-09 18:41  micael

	* [r5177] liboct_parser/Makefile.am: Wrong filename...

2009-04-09 22:05  xavier

	* [r5178] src/basic/units.F90, src/ions/ion_interaction.F90,
	  src/ions/simul_box.F90, src/ions/solids.F90,
	  src/opt_control/parameters.F90, src/species/atomic.F90,
	  src/species/ps_hgh.F90, src/species/ps_psf.F90,
	  src/utils/phonon_spectrum.F90: Tobias' patch: several literals
	  were defined without the proper
	  precision.

2009-04-10 06:13  xavier

	* [r5179] src/scf/scf.F90: K point parallelization: Angular
	  momentum information is now
	  allgathered.

2009-04-10 06:36  xavier

	* [r5180] src/states/states_calc_inc.F90: Bugfix: static arrays
	  should have dimensions known at compilation
	  time.
	  
	  Please be careful with this.

2009-04-10 07:02  xavier

	* [r5181] src/states/states_calc_inc.F90: Parallelization in k
	  points: now momemtum is allgathered.

2009-04-10 07:17  xavier

	* [r5182] src/basic/calc_mode.F90: Restricted parallelization modes
	  for the release: only the ground
	  state is parallelizable in k points (the rest hasn't been tested)
	  and
	  only the time propagation is parallel in states.

2009-04-10 12:40  acastro

	* [r5183] src/grid/hypercube.F90, src/grid/index.F90: Bug fix: for
	  lower dimensional cases, the functions were not printed
	  properly by the "output_function" routines, because of an
	  intent(out)
	  argument that was not set to zero as it should.

2009-04-10 12:49  xavier

	* [r5184] src/basic/messages.F90, src/scf/eigen.F90, src/td/td.F90,
	  testsuite/finite_systems_3d/20-eigensolver.06-rmmdiis.inp,
	  testsuite/periodic_systems/05-lithium.02-td.inp,
	  testsuite/periodic_systems/05-lithium.03-td-restart.inp: * Added
	  the function messages_devel_version to mark code that should
	  be used only in development mode.
	  
	  * Restricted time propagation for solids to development mode.
	  
	  * Restricted the rmmdiis eigensolver to development mode.

2009-04-10 15:06  xavier

	* [r5185] testsuite/finite_systems_3d/24-o2-spin.01-gs.inp,
	  testsuite/finite_systems_3d/24-o2-spin.test,
	  testsuite/finite_systems_3d/Makefile.am: Added a test for
	  parallelization over spin.

2009-04-11 07:26  xavier

	* [r5186] testsuite/finite_systems_1d/01-hydrogen.test,
	  testsuite/finite_systems_1d/02-neon_mpi.test,
	  testsuite/finite_systems_1d/09-morse.test,
	  testsuite/finite_systems_2d/01-quadratic_box.test,
	  testsuite/finite_systems_2d/02-fock-darwin.test,
	  testsuite/finite_systems_2d/03-helium_atom.test,
	  testsuite/finite_systems_2d/04-biot_savart.test,
	  testsuite/finite_systems_2d/05-spin_precession.test,
	  testsuite/finite_systems_2d/06-tdmagnetic.test,
	  testsuite/finite_systems_2d/07-hartree_fock.test,
	  testsuite/finite_systems_3d/01-carbon_atom.test,
	  testsuite/finite_systems_3d/02-curvlinear_coordinates.test,
	  testsuite/finite_systems_3d/03-functionals.test,
	  testsuite/finite_systems_3d/04-jellium.test,
	  testsuite/finite_systems_3d/05-multigrid_solver.test,
	  testsuite/finite_systems_3d/06-restart.test,
	  testsuite/finite_systems_3d/07-spin_orbit_coupling.test,
	  testsuite/finite_systems_3d/08-spin_orbit_coupling_full.test,
	  testsuite/finite_systems_3d/09-spinors.test,
	  testsuite/finite_systems_3d/11-sic.test,
	  testsuite/finite_systems_3d/12-forces.test,
	  testsuite/finite_systems_3d/13-full_potential_hydrogen.test,
	  testsuite/finite_systems_3d/15-hartree.test,
	  testsuite/finite_systems_3d/16-isf_solver.test,
	  testsuite/finite_systems_3d/18-current.test,
	  testsuite/finite_systems_3d/19-laser.test,
	  testsuite/finite_systems_3d/20-eigensolver.test,
	  testsuite/finite_systems_3d/21-lobpcg.test,
	  testsuite/finite_systems_3d/22-time_propagation.test,
	  testsuite/finite_systems_3d/23-go-na2.test,
	  testsuite/linear_response/01-casida.test,
	  testsuite/linear_response/02-h2o_pol_lr.test,
	  testsuite/linear_response/03-vdw_sternheimer.test,
	  testsuite/linear_response/04-vib_modes.test,
	  testsuite/linear_response/05-polarizability.test,
	  testsuite/oct-run_regression_test.pl,
	  testsuite/open_systems/01-wavepacket.test,
	  testsuite/open_systems/02-wavepacket_2d.test,
	  testsuite/open_systems/03-extended_eigenstate.test,
	  testsuite/open_systems/04-propagate_eigenstate.test,
	  testsuite/optimal_control/01-asym_doublewell.test,
	  testsuite/optimal_control/02-sym_doublewell.test,
	  testsuite/optimal_control/03-localtarget.test,
	  testsuite/optimal_control/04-box.test,
	  testsuite/optimal_control/05-adw.test,
	  testsuite/optimal_control/06-zbr98.test,
	  testsuite/periodic_systems/01-free_electrons.test,
	  testsuite/periodic_systems/02-cosine_potential.test,
	  testsuite/periodic_systems/03-sodium_chain.test,
	  testsuite/periodic_systems/04-silicon.test,
	  testsuite/periodic_systems/05-lithium.test,
	  testsuite/real_time/01-etrs.test,
	  testsuite/real_time/02-aetrs.test,
	  testsuite/real_time/03-exp_mid.test,
	  testsuite/real_time/04-etrs_single.test,
	  testsuite/real_time/05-cpmd.test,
	  testsuite/real_time/07-visscher.test: The test files had several
	  fields that are not used so I removed them
	  (many of these fields were outdated anyway).

2009-04-11 07:39  xavier

	* [r5187] testsuite/periodic_systems/05-lithium.01-gs.inp,
	  testsuite/periodic_systems/05-lithium.test: Enabled k point
	  parallelization of the lithium test.

2009-04-11 08:03  xavier

	* [r5188] src/sternheimer/sternheimer.F90: Restricted Sternheimer
	  for periodic system to development version.

2009-04-11 09:51  xavier

	* [r5189] src/grid/curvlinear.F90, src/grid/double_grid.F90,
	  src/grid/double_grid_apply.F90, src/grid/nl_operator.F90,
	  src/system/v_ks.F90, src/system/xc_OEP.F90: Replaced all checks
	  for conf%devel_version by calls to
	  messages_devel_version.

2009-04-11 15:12  xavier

	* [r5190] src/sternheimer/sternheimer.F90: Preorthogonalization is
	  only enabled if semiconductor smearing is
	  used. This fixes the polarizability test.

2009-04-11 15:32  xavier

	* [r5191] src/system/preconditioners.F90: Sometimes the filter
	  preconditioner gives problems for periodic
	  systems, so it is now disabled in that case.

2009-04-11 15:54  xavier

	* [r5192]
	  testsuite/finite_systems_3d/01-carbon_atom.03-ground_state_double_grid.inp:
	  This test has to run as DevelVersion.

2009-04-11 16:02  xavier

	* [r5193] src/ions/ion_dynamics.F90: Restricted the (half
	  implemented) Nose-Hoover thermostat to the
	  development version.

2009-04-11 16:52  xavier

	* [r5194] src/grid/mesh_function_inc.F90,
	  src/system/output_h_sys.F90, src/system/output_states.F90:
	  Bugfix: the Biot Savart test did not work in parallel.

2009-04-12 05:20  dstrubbe

	* [r5195] src/sternheimer/em_resp.F90: *) Previous formulation of
	  hyper-Rayleigh scattering (HRS) hyperpolarizabilities implicitly
	  assumed Kleinman symmetry (permutation of indices). Now I have
	  generalized the equations, as is needed for the non-static case.
	  *) HRS hyperpolarizability is now properly computed as a complex
	  number rather than a real number, since it can be complex when
	  omega or eta is nonzero.
	  *) Noted that these HRS hyperpolarizabilities apply only to the
	  liquid or gas phase, where there is no long-range order so
	  orientations are uncorrelated and isotropic. In a crystal, the
	  tensor components of beta would be used directly to study HRS.

2009-04-12 08:27  acastro

	* [r5196] src/opt_control/propagation.F90, src/system/v_ks.F90,
	  src/td/td_rti.F90: A few details:
	  o Eliminated one long-standing memory leak that
	  appeared in OCT runs.
	  o One line was too long for compiler for compilers restricted
	  with the 132 columns rule.
	  o One uninitialized variable.

2009-04-12 20:03  dstrubbe

	* [r5197] src/sternheimer/em_resp.F90: *) Reorganized subroutines
	  in em_resp to undo an unnecessary change I made a while ago
	  *) Hyperpolarizability beta file was being written for the
	  frequency corresponding to each factor, which is misleading since
	  it only corresponds to one frequency, and could also cause extra
	  confusion by overwriting previous beta files in a calculation
	  with multiple frequencies. Now it is written only for the first
	  factor, and the documentation says so.
	  *) The wavefunctions and circular dichroism files were being
	  written to a directory labelled by the frequency (without the
	  factors), which is incorrect since they are actually calculated
	  for the frequency times the factors. Now they are written for
	  each factor in the appropriate directories.

2009-04-12 21:51  dstrubbe

	* [r5198] src/main/main.F90, src/opt_control/target.F90,
	  src/scf/scf.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90: *) Noted in documentation runs that
	  are development-only.
	  *) Added variable to enable calculation of Born charges, so that
	  this can be marked development-only.
	  *) Broke up a line that was too long and preventing compilation
	  in some builds
	  *) Marked kdotp run as development-only: I am pretty confident
	  about the k.p wavefunctions, but the effective masses have some
	  problems, and k.p is only useful for periodic em_resp which is
	  development-only anyway.
	  *) Added geometry to output_function calls in opt_control/target
	  so that XCrySDen output format can be used.
	  *) Explained warning on single-point Berry's phase for multiple
	  k-points more.

2009-04-13 07:25  xavier

	* [r5199] testsuite/linear_response/01-casida.test: Enabled the
	  casida test in parallel.

2009-04-13 08:26  xavier

	* [r5200] src/grid/io_function_inc.F90,
	  src/grid/mesh_function_inc.F90, src/hamiltonian/hamiltonian.F90,
	  src/ions/simul_box.F90, src/main/casida.F90,
	  src/poisson/poisson_cutoffs.c, src/scf/eigen.F90,
	  src/scf/eigen_lobpcg_inc.F90, src/states/density_matrix.F90,
	  src/states/ksinversion.F90, src/states/restart.F90,
	  src/states/states.F90, src/sternheimer/em_resp.F90,
	  src/sternheimer/kdotp.F90, src/system/v_ks.F90,
	  src/td/ob_rti.F90, src/utils/harmonic_spectrum.F90: Removed
	  several unused variables.

2009-04-13 09:02  xavier

	* [r5201] src/ions/simul_box.F90, src/main/gcm.F90,
	  src/main/main.F90, src/sternheimer/raman.F90: Restricted some
	  parts to developmente version:
	  
	  * Open boundaries
	  * Raman
	  * GCM

2009-04-13 22:25  xavier

	* [r5202] libxc/Makefile.am, share/Makefile.am: This fixes the
	  problem with make distcheck.

2009-04-13 22:35  xavier

	* [r5203] src/scf/lcao_inc.F90: A line was too long.

2009-04-14 07:41  marques

	* [r5204] share/Makefile.am: Xavier, your change deleted some
	  distributed files when performing make distcheck. This should
	  correct it.

2009-04-14 08:25  marques

	* [r5205] share/Makefile.am: Another try at the distcheck problem

2009-04-14 09:49  xavier

	* [r5206] src/hamiltonian/ob_lead.F90: Bugfix: A non-initialized
	  variable.

2009-04-14 10:22  xavier

	* [r5207] src/species/atomic.F90, src/species/ps_psf.F90,
	  src/td/ob_rti.F90: Fixed some compiler warnings.

